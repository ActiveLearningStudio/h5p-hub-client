{"version":3,"sources":["webpack:///webpack/bootstrap 64e9c28e2873ec75257c","webpack:///./src/scripts/mixins/eventful.js","webpack:///./~/h5p-sdk/src/scripts/utils/functional.js","webpack:///./~/h5p-sdk/src/scripts/utils/elements.js","webpack:///./src/scripts/utils/errors.js","webpack:///./src/scripts/hub-services.js","webpack:///./~/h5p-sdk/src/scripts/components/panel.js","webpack:///./src/scripts/hub.js","webpack:///./src/styles/main.scss","webpack:///./~/h5p-sdk/src/scripts/components/tab-panel.js","webpack:///./~/lunr/lunr.js","webpack:///./src/scripts/content-type-detail/content-type-detail-view.js","webpack:///./src/scripts/content-type-detail/content-type-detail.js","webpack:///./src/scripts/content-type-list/content-type-list-view.js","webpack:///./src/scripts/content-type-list/content-type-list.js","webpack:///./src/scripts/content-type-section/content-type-section-view.js","webpack:///./src/scripts/content-type-section/content-type-section.js","webpack:///./src/scripts/hub-view.js","webpack:///./src/scripts/search-service/search-service.js","webpack:///./src/scripts/upload-section/upload-section.js","webpack:///./src/entries/dist.js"],"names":["Eventful","listeners","on","type","listener","scope","trigger","push","fire","event","triggers","every","call","propagate","types","eventful","self","forEach","curry","fn","arity","length","f1","args","Array","prototype","slice","arguments","apply","f2","args2","concat","compose","fns","reduce","f","g","arr","map","filter","some","contains","value","indexOf","without","values","inverseBooleanString","bool","toString","getAttribute","name","el","setAttribute","removeAttribute","hasAttribute","attributeEquals","toggleAttribute","appendChild","parent","child","querySelector","selector","querySelectorAll","renderErrorMessage","message","console","log","closeButton","document","createElement","className","innerHTML","messageContent","content","messageWrapper","dismissible","HubServices","apiRootUrl","window","cachedContentTypes","fetch","method","credentials","then","result","json","isValid","libraries","response","messageCode","Promise","reject","resolve","machineName","contentTypes","contentType","id","body","init","isExpanded","hide","show","toggleBodyVisibility","bodyElement","style","height","scrollHeight","onAriaExpandedChange","target","element","titleEl","bodyId","bodyEl","observer","MutationObserver","observe","attributes","attributeOldValue","attributeFilter","addEventListener","Hub","state","contentTypeSection","uploadSection","view","services","setPanelTitle","closePanel","initTabPanel","getContentType","title","setTitle","tabConfigs","getElement","selected","addTab","tabConfig","hideAll","unSelectAll","tabs","tabPanels","tab","tabPanelId","lunr","config","idx","Index","pipeline","add","trimmer","stopWordFilter","stemmer","version","utils","warn","global","asString","obj","EventEmitter","events","addListener","pop","names","TypeError","hasHandler","removeListener","fnIndex","splice","emit","undefined","tokenizer","isArray","t","toLowerCase","trim","split","separator","load","label","registeredFunctions","Error","registerFunction","Pipeline","_stack","warnIfFunctionNotRegistered","isRegistered","serialised","fnName","after","existingFn","newFn","pos","before","remove","run","tokens","out","tokenLength","stackLength","i","token","j","reset","toJSON","Vector","_magnitude","list","Node","val","next","insert","prev","magnitude","node","sumOfSquares","Math","sqrt","dot","otherVector","otherNode","dotProduct","similarity","SortedSet","elements","serialisedData","set","locationFor","toArray","ctx","elem","start","end","sectionLength","pivot","floor","pivotElem","intersect","otherSet","intersectSet","a_len","b_len","a","b","clone","union","longSet","shortSet","unionSet","shortSetElements","_fields","_ref","documentStore","Store","tokenStore","TokenStore","corpusTokens","eventEmitter","tokenizerFn","_idfCache","bind","off","fields","ref","field","fieldName","opts","boost","refName","doc","emitEvent","docTokens","allDocumentTokens","docRef","fieldTokens","tf","fieldLength","tokenCount","k","has","get","update","idf","term","cacheKey","Object","hasOwnProperty","documentFrequency","count","search","query","queryTokens","queryVector","documentSets","fieldBoosts","memo","hasSomeToken","expand","key","similarityBoost","diff","max","matchingDocuments","refs","keys","refsLen","documentSet","score","documentVector","sort","documentRef","documentTokens","documentTokensLength","use","plugin","unshift","store","step2list","step3list","c","v","C","V","mgr0","meq1","mgr1","s_v","re_mgr0","RegExp","re_mgr1","re_meq1","re_s_v","re_1a","re2_1a","re_1b","re2_1b","re_1b_2","re2_1b_2","re3_1b_2","re4_1b_2","re_1c","re_2","re_3","re_4","re2_4","re_5","re_5_1","re3_5","porterStemmer","w","stem","suffix","firstch","re","re2","re3","re4","substr","toUpperCase","test","replace","fp","exec","generateStopWordFilter","stopWords","words","stopWord","root","docs","charAt","rest","getNode","factory","define","exports","module","ATTRIBUTE_CONTENT_TYPE_ID","toggleVisibility","visible","isEmpty","text","relayClickEventAs","ContentTypeDetailView","backButtonElement","image","imageWrapperElement","description","demoButton","textDetails","detailsElement","useButton","installButton","buttonBar","licencePanel","createPanel","pluginsPanel","publisherPanel","panelGroupElement","rootElement","headerEl","bodyInnerEl","panelEl","src","url","installed","ContentTypeDetail","install","installContentType","debug","setId","setDescription","setImage","icon","setExample","example","setIsInstalled","preventDefault","ContentTypeListView","firstChild","removeChild","renderContentTypeList","createContentTypeRow","summary","row","createButtonElement","button","ContentTypeList","updateList","ContentBrowserView","menu","createMenuElement","inputGroup","createInputGroupElement","menuGroup","menuBarElement","childElementCount","navElement","inputField","inputButton","inputGroupWrapper","ContentTypeSection","searchService","contentTypeList","contentTypeDetail","addMenuItem","menuText","applySearchFilter","showDetailView","closeDetailView","initContentTypeList","catch","error","loadById","ATTRIBUTE_ARIA_EXPANDED","HubView","renderTabPanel","renderPanel","sectionId","expanded","tabContainerElement","tablist","tabListWrapper","tabId","tabPanel","findContentTypeByMachineName","addToIndex","index","SearchService","UploadSection","require","H5P","HubClient","default"],"mappings":"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","file":"h5p-hub-client.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 19);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 64e9c28e2873ec75257c","/**\r\n * @mixin\r\n */\r\nexport const Eventful = () => ({\r\n  listeners: {},\r\n\r\n  /**\r\n   * Listen to event\r\n   *\r\n   * @param {string} type\r\n   * @param {function} listener\r\n   * @param {object} [scope]\r\n   *\r\n   * @function\r\n   */\r\n  on: function(type, listener, scope) {\r\n    /**\r\n     * @typedef {object} Trigger\r\n     * @property {function} listener\r\n     * @property {object} scope\r\n     */\r\n    const trigger = {\r\n      'listener': listener,\r\n      'scope': scope\r\n    };\r\n\r\n    this.listeners[type] = this.listeners[type] || [];\r\n    this.listeners[type].push(trigger);\r\n  },\r\n\r\n  /**\r\n   * Fire event. If any of the listeners returns false, return false\r\n   *\r\n   * @param {string} type\r\n   * @param {object} [event]\r\n   *\r\n   * @function\r\n   * @return {boolean}\r\n   */\r\n  fire: function(type, event) {\r\n    const triggers = this.listeners[type] || [];\r\n\r\n    return triggers.every(function(trigger) {\r\n      return trigger.listener.call(trigger.scope || this, event) !== false;\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Listens for events on another Eventful, and propagate it trough this Eventful\r\n   *\r\n   * @param {string[]} types\r\n   * @param {Eventful} eventful\r\n   */\r\n  propagate: function(types, eventful) {\r\n    let self = this;\r\n    types.forEach(type => eventful.on(type, event => self.fire(type, event)));\r\n  }\r\n});\n\n\n// WEBPACK FOOTER //\n// ./src/scripts/mixins/eventful.js","/**\r\n * Returns a curried version of a function\r\n *\r\n * @param {function} fn\r\n *\r\n * @public\r\n *\r\n * @return {function}\r\n */\r\nexport const curry = function(fn) {\r\n  const arity = fn.length;\r\n\r\n  return function f1() {\r\n    const args = Array.prototype.slice.call(arguments, 0);\r\n    if (args.length >= arity) {\r\n      return fn.apply(null, args);\r\n    }\r\n    else {\r\n      return function f2() {\r\n        const args2 = Array.prototype.slice.call(arguments, 0);\r\n        return f1.apply(null, args.concat(args2));\r\n      }\r\n    }\r\n  };\r\n};\r\n\r\n/**\r\n * Compose functions together, executing from right to left\r\n *\r\n * @param {function...} fns\r\n *\r\n * @function\r\n * @public\r\n *\r\n * @return {function}\r\n */\r\nexport const compose = (...fns) => fns.reduce((f, g) => (...args) => f(g(...args)));\r\n\r\n/**\r\n * Applies a function to each element in an array\r\n *\r\n * @param {function} fn\r\n * @param {Array} arr\r\n *\r\n * @function\r\n * @public\r\n *\r\n * @return {function}\r\n */\r\nexport const forEach = curry(function (fn, arr) {\r\n  arr.forEach(fn);\r\n});\r\n\r\n/**\r\n * Maps a function to an array\r\n *\r\n * @param {function} fn\r\n * @param {Array} arr\r\n *\r\n * @function\r\n * @public\r\n *\r\n * @return {function}\r\n */\r\nexport const map = curry(function (fn, arr) {\r\n  return arr.map(fn);\r\n});\r\n\r\n/**\r\n * Applies a filter to an array\r\n *\r\n * @param {function} fn\r\n * @param {Array} arr\r\n *\r\n * @function\r\n * @public\r\n *\r\n * @return {function}\r\n */\r\nexport const filter = curry(function (fn, arr) {\r\n  return arr.filter(fn);\r\n});\r\n\r\n/**\r\n * Applies a some to an array\r\n *\r\n * @param {function} fn\r\n * @param {Array} arr\r\n *\r\n * @function\r\n * @public\r\n *\r\n * @return {function}\r\n */\r\nexport const some = curry(function (fn, arr) {\r\n  return arr.some(fn);\r\n});\r\n\r\n/**\r\n * Returns true if an array contains a value\r\n *\r\n * @param {*} value\r\n * @param {Array} arr\r\n *\r\n * @function\r\n * @public\r\n *\r\n * @return {function}\r\n */\r\nexport const contains = curry(function (value, arr) {\r\n  return arr.indexOf(value) != -1;\r\n});\r\n\r\n/**\r\n * Returns an array without the supplied values\r\n *\r\n * @param {Array} values\r\n * @param {Array} arr\r\n *\r\n * @function\r\n * @public\r\n *\r\n * @return {function}\r\n */\r\nexport const without = curry(function (values, arr) {\r\n  return filter(value => !contains(value, values), arr)\r\n});\r\n\r\n/**\r\n * Takes a string that is either 'true' or 'false' and returns the opposite\r\n *\r\n * @param {string} bool\r\n *\r\n * @public\r\n * @return {string}\r\n */\r\nexport const inverseBooleanString = function (bool) {\r\n  return (bool !== 'true').toString();\r\n};\n\n\n// WEBPACK FOOTER //\n// ./~/h5p-sdk/src/scripts/utils/functional.js","import {curry, inverseBooleanString} from './functional'\r\n\r\n/**\r\n * Get an attribute value from element\r\n *\r\n * @param {string} name\r\n * @param {HTMLElement} el\r\n *\r\n * @function\r\n * @return {string}\r\n */\r\nexport const getAttribute = curry(function (name, el) {\r\n  return el.getAttribute(name);\r\n});\r\n\r\n/**\r\n * Set an attribute on a html element\r\n *\r\n * @param {string} name\r\n * @param {string} value\r\n * @param {HTMLElement} el\r\n *\r\n * @function\r\n */\r\nexport const setAttribute = curry(function (name, value, el) {\r\n  el.setAttribute(name, value);\r\n});\r\n\r\n/**\r\n * Remove attribute from html element\r\n *\r\n * @param {string} name\r\n * @param {HTMLElement} el\r\n *\r\n * @function\r\n */\r\nexport const removeAttribute = curry(function (name, el) {\r\n  el.removeAttribute(name);\r\n});\r\n\r\n/**\r\n * Check if element has an attribute\r\n *\r\n * @param {string} name\r\n * @param {HTMLElement} el\r\n *\r\n * @function\r\n * @return {boolean}\r\n */\r\nexport const hasAttribute = curry(function (name, el) {\r\n  return el.hasAttribute(name);\r\n});\r\n\r\n/**\r\n * Check if element has an attribute that equals\r\n *\r\n * @param {string} name\r\n * @param {string} value\r\n * @param {HTMLElement} el\r\n *\r\n * @function\r\n * @return {boolean}\r\n */\r\nexport const attributeEquals = curry(function (name, value, el) {\r\n  return el.getAttribute(name) === value;\r\n});\r\n\r\n/**\r\n * Toggles an attribute between 'true' and 'false';\r\n *\r\n * @param {string} name\r\n * @param {HTMLElement} el\r\n *\r\n * @function\r\n */\r\nexport const toggleAttribute = curry(function (name, el) {\r\n  const value = getAttribute(name, el);\r\n  setAttribute(name, inverseBooleanString(value), el);\r\n});\r\n\r\n/**\r\n * The appendChild() method adds a node to the end of the list of children of a specified parent node.\r\n *\r\n * @param {HTMLElement} parent\r\n * @param {HTMLElement} child\r\n *\r\n * @function\r\n * @return {HTMLElement}\r\n */\r\nexport const appendChild = curry(function (parent, child) {\r\n  return parent.appendChild(child);\r\n});\r\n\r\n/**\r\n * Returns the first element that is a descendant of the element on which it is invoked\r\n * that matches the specified group of selectors.\r\n *\r\n * @param {string} selector\r\n * @param {HTMLElement} el\r\n *\r\n * @function\r\n * @return {HTMLElement}\r\n */\r\nexport const querySelector = curry(function (selector, el) {\r\n  return el.querySelector(selector);\r\n});\r\n\r\n/**\r\n * Returns a non-live NodeList of all elements descended from the element on which it\r\n * is invoked that matches the specified group of CSS selectors.\r\n *\r\n * @param {string} selector\r\n * @param {HTMLElement} el\r\n *\r\n * @function\r\n * @return {NodeList}\r\n */\r\nexport const querySelectorAll = curry(function (selector, el) {\r\n  return el.querySelectorAll(selector);\r\n});\n\n\n// WEBPACK FOOTER //\n// ./~/h5p-sdk/src/scripts/utils/elements.js","/**\r\n * @param  {string}   config.type         type of the message: info, success, error\r\n * @param  {boolean}  config.dismissible  whether the message can be dismissed\r\n * @param  {string}   config.content      message content usually a 'h3' and a 'p'\r\n * @return {HTMLElement} div containing the message element\r\n */\r\n\r\n//TODO handle strings, html, badly formed object\r\nexport default function renderErrorMessage(message) {\r\n  console.log(message);\r\n  const closeButton = document.createElement('div');\r\n  closeButton.className = 'close';\r\n  closeButton.innerHTML = '&#x2715';\r\n\r\n  const messageContent = document.createElement('div');\r\n  messageContent.className = 'message-content';\r\n  messageContent.innerHTML = message.content;\r\n\r\n  const messageWrapper = document.createElement('div');\r\n  messageWrapper.className = 'message' + ' ' + `${message.type}` + (message.dismissible ? ' dismissible' : '');\r\n  messageWrapper.appendChild(closeButton);\r\n  messageWrapper.appendChild(messageContent);\r\n  console.log(messageWrapper);\r\n  return messageWrapper;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/scripts/utils/errors.js","/**\r\n * @typedef {object} ContentType\r\n * @property {string} id\r\n * @property {string} title\r\n * @property {string} summary\r\n * @property {string} description\r\n * @property {string} icon\r\n * @property {string} created\r\n * @property {string} update\r\n * @property {boolean} recommended\r\n * @property {number} timesDownloaded\r\n * @property {string[]} screenshots\r\n * @property {string} example\r\n * @property {string[]} keywords\r\n * @property {string[]} categories\r\n * @property {string} license\r\n */\r\n\r\nexport default class HubServices {\r\n  /**\r\n   * @param {string} apiRootUrl\r\n   */\r\n  constructor({ apiRootUrl }) {\r\n    this.apiRootUrl = apiRootUrl;\r\n\r\n    if(!window.cachedContentTypes){\r\n      window.cachedContentTypes = fetch(`${this.apiRootUrl}content-type-cache`, {\r\n        method: 'GET',\r\n        credentials: 'include'\r\n      })\r\n      .then(result => result.json())\r\n      .then(this.isValid)\r\n      .then(json => json.libraries);\r\n    }\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param  {Object} response\r\n   * @return {Promise<ContentType[] | ErrorMessage>}\r\n   */\r\n  isValid(response) {\r\n    if (response.messageCode) {\r\n      return Promise.reject(response);\r\n    }\r\n    else {\r\n      return Promise.resolve(response);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Returns a list of content types\r\n   *\r\n   * @return {Promise.<ContentType[]>}\r\n   */\r\n  contentTypes() {\r\n    return window.cachedContentTypes;\r\n  }\r\n\r\n  /**\r\n   * Returns a Content Type\r\n   *\r\n   * @param {string} machineName\r\n   *\r\n   * @return {Promise.<ContentType>}\r\n   */\r\n  contentType(machineName) {\r\n    return window.cachedContentTypes.then(contentTypes => {\r\n      return contentTypes.filter(contentType => contentType.machineName === machineName)[0];\r\n    });\r\n\r\n    /*return fetch(`${this.apiRootUrl}content_type_cache/${id}`, {\r\n      method: 'GET',\r\n      credentials: 'include'\r\n    }).then(result => result.json());*/\r\n  }\r\n\r\n  /**\r\n   * Installs a content type on the server\r\n   *\r\n   * @param {string} id\r\n   *\r\n   * @return {Promise.<ContentType>}\r\n   */\r\n  installContentType(id) {\r\n    return fetch(`${this.apiRootUrl}library-install?id=${id}`, {\r\n      method: 'POST',\r\n      credentials: 'include',\r\n      body: ''\r\n    }).then(result => result.json());\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/scripts/hub-services.js","import {setAttribute, attributeEquals, toggleAttribute} from '../utils/elements';\r\nimport {curry, forEach} from '../utils/functional';\r\n\r\n/**\r\n * @type {function}\r\n */\r\nconst isExpanded = attributeEquals(\"aria-expanded\", 'true');\r\n\r\n/**\r\n * @type {function}\r\n */\r\nconst hide = setAttribute('aria-hidden', 'true');\r\n\r\n/**\r\n * @type {function}\r\n */\r\nconst show = setAttribute('aria-hidden', 'false');\r\n\r\n/**\r\n * Toggles the body visibility\r\n *\r\n * @param {HTMLElement} bodyElement\r\n * @param {boolean} isExpanded\r\n */\r\nconst toggleBodyVisibility = function(bodyElement, isExpanded) {\r\n  if(isExpanded) {\r\n    show(bodyElement);\r\n    bodyElement.style.height = `${bodyElement.scrollHeight}px`;\r\n  }\r\n  else {\r\n    hide(bodyElement);\r\n    bodyElement.style.height = \"0\";\r\n  }\r\n};\r\n\r\n/**\r\n * Handles changes to aria-expanded\r\n *\r\n * @param {HTMLElement} bodyElement\r\n * @param {MutationRecord} event\r\n *\r\n * @function\r\n */\r\nconst onAriaExpandedChange = curry(function(bodyElement, event) {\r\n  toggleBodyVisibility(bodyElement, isExpanded(event.target));\r\n});\r\n\r\n/**\r\n * Initializes a panel\r\n *\r\n * @param {HTMLElement} element\r\n * @return {HTMLElement}\r\n */\r\nexport default function init(element) {\r\n  const titleEl = element.querySelector('[aria-expanded]');\r\n  const bodyId = titleEl.getAttribute('aria-controls');\r\n  const bodyEl = element.querySelector(`#${bodyId}`);\r\n\r\n  if(titleEl) {\r\n    // set observer on title for aria-expanded\r\n    let observer = new MutationObserver(forEach(onAriaExpandedChange(bodyEl)));\r\n\r\n    observer.observe(titleEl, {\r\n      attributes: true,\r\n      attributeOldValue: true,\r\n      attributeFilter: [\"aria-expanded\"]\r\n    });\r\n\r\n    // Set click listener that toggles aria-expanded\r\n    titleEl.addEventListener('click', function(event) {\r\n      toggleAttribute(\"aria-expanded\", event.target);\r\n    });\r\n\r\n    toggleBodyVisibility(bodyEl, isExpanded(titleEl));\r\n  }\r\n\r\n  return element;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./~/h5p-sdk/src/scripts/components/panel.js","import HubView from './hub-view';\r\nimport ContentTypeSection from './content-type-section/content-type-section';\r\nimport UploadSection from './upload-section/upload-section';\r\nimport HubServices from './hub-services';\r\nimport { Eventful } from './mixins/eventful';\r\nimport {renderErrorMessage} from './utils/errors';\r\n\r\n/**\r\n * @typedef {object} HubState\r\n * @property {string} title\r\n * @property {string} sectionId\r\n * @property {boolean} expanded\r\n * @property {string} apiRootUrl\r\n */\r\n/**\r\n * @class\r\n * @mixes Eventful\r\n */\r\nexport default class Hub {\r\n  /**\r\n   * @param {HubState} state\r\n   */\r\n  constructor(state) {\r\n    // add event system\r\n    Object.assign(this, Eventful());\r\n\r\n    // controllers\r\n    this.contentTypeSection = new ContentTypeSection(state);\r\n    this.uploadSection = new UploadSection(state);\r\n\r\n    // views\r\n    this.view = new HubView(state);\r\n\r\n    // services\r\n    this.services = new HubServices({\r\n      apiRootUrl: state.apiRootUrl\r\n    });\r\n\r\n    // propagate controller events\r\n    this.propagate(['select', 'error'], this.contentTypeSection);\r\n\r\n    // handle events\r\n    this.on('select', this.setPanelTitle, this);\r\n    this.on('select', this.view.closePanel, this.view);\r\n    \r\n    this.initTabPanel()\r\n  }\r\n\r\n  /**\r\n   * Returns the promise of a content type\r\n   * @param {string} machineName\r\n   * @return {Promise.<ContentType>}\r\n   */\r\n  getContentType(machineName) {\r\n    return this.services.contentType(machineName);\r\n  }\r\n\r\n  /**\r\n   * Sets the title of the panel\r\n   *\r\n   * @param {string} id\r\n   */\r\n  setPanelTitle({id}) {\r\n    this.getContentType(id).then(({title}) => this.view.setTitle(title));\r\n  }\r\n\r\n  /**\r\n   * Initiates the tab panel\r\n   */\r\n  initTabPanel() {\r\n    const tabConfigs = [{\r\n      title: 'Create Content',\r\n      id: 'create-content',\r\n      content: this.contentTypeSection.getElement(),\r\n      selected: true\r\n    },\r\n    {\r\n      title: 'Upload',\r\n      id: 'upload-section',\r\n      content: this.uploadSection.getElement()\r\n    }];\r\n\r\n    tabConfigs.forEach(tabConfig => this.view.addTab(tabConfig));\r\n    this.view.initTabPanel();\r\n  }\r\n\r\n  /**\r\n   * Returns the root element in the view\r\n   *\r\n   * @return {HTMLElement}\r\n   */\r\n  getElement() {\r\n    return this.view.getElement();\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/scripts/hub.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/styles/main.scss\n// module id = 7\n// module chunks = 0","import {setAttribute} from '../utils/elements';\r\nimport {forEach} from '../utils/functional';\r\n\r\n/**\r\n * @type {function}\r\n */\r\nconst hideAll = forEach(setAttribute('aria-hidden', 'true'));\r\n\r\n/**\r\n * @type {function}\r\n */\r\nconst show = setAttribute('aria-hidden', 'false');\r\n\r\n/**\r\n * @type {function}\r\n */\r\nconst unSelectAll = forEach(setAttribute('aria-selected', 'false'));\r\n\r\n/**\r\n * Initiates a tab panel\r\n *\r\n * @param {HTMLElement} element\r\n */\r\nexport default function init(element) {\r\n  const tabs = element.querySelectorAll('[role=\"tab\"]');\r\n  const tabPanels = element.querySelectorAll('[role=\"tabpanel\"]');\r\n\r\n  tabs.forEach(tab => {\r\n    tab.addEventListener('click', function (event) {\r\n\r\n      unSelectAll(tabs);\r\n      event.target.setAttribute('aria-selected', 'true');\r\n\r\n      hideAll(tabPanels);\r\n\r\n      let tabPanelId = event.target.getAttribute('aria-controls');\r\n      show(element.querySelector(`#${tabPanelId}`));\r\n    });\r\n  })\r\n}\n\n\n// WEBPACK FOOTER //\n// ./~/h5p-sdk/src/scripts/components/tab-panel.js","/**\n * lunr - http://lunrjs.com - A bit like Solr, but much smaller and not as bright - 1.0.0\n * Copyright (C) 2017 Oliver Nightingale\n * @license MIT\n */\n\n;(function(){\n\n/**\n * Convenience function for instantiating a new lunr index and configuring it\n * with the default pipeline functions and the passed config function.\n *\n * When using this convenience function a new index will be created with the\n * following functions already in the pipeline:\n *\n * lunr.StopWordFilter - filters out any stop words before they enter the\n * index\n *\n * lunr.stemmer - stems the tokens before entering the index.\n *\n * Example:\n *\n *     var idx = lunr(function () {\n *       this.field('title', 10)\n *       this.field('tags', 100)\n *       this.field('body')\n *       \n *       this.ref('cid')\n *       \n *       this.pipeline.add(function () {\n *         // some custom pipeline function\n *       })\n *       \n *     })\n *\n * @param {Function} config A function that will be called with the new instance\n * of the lunr.Index as both its context and first parameter. It can be used to\n * customize the instance of new lunr.Index.\n * @namespace\n * @module\n * @returns {lunr.Index}\n *\n */\nvar lunr = function (config) {\n  var idx = new lunr.Index\n\n  idx.pipeline.add(\n    lunr.trimmer,\n    lunr.stopWordFilter,\n    lunr.stemmer\n  )\n\n  if (config) config.call(idx, idx)\n\n  return idx\n}\n\nlunr.version = \"1.0.0\"\n/*!\n * lunr.utils\n * Copyright (C) 2017 Oliver Nightingale\n */\n\n/**\n * A namespace containing utils for the rest of the lunr library\n */\nlunr.utils = {}\n\n/**\n * Print a warning message to the console.\n *\n * @param {String} message The message to be printed.\n * @memberOf Utils\n */\nlunr.utils.warn = (function (global) {\n  return function (message) {\n    if (global.console && console.warn) {\n      console.warn(message)\n    }\n  }\n})(this)\n\n/**\n * Convert an object to a string.\n *\n * In the case of `null` and `undefined` the function returns\n * the empty string, in all other cases the result of calling\n * `toString` on the passed object is returned.\n *\n * @param {Any} obj The object to convert to a string.\n * @return {String} string representation of the passed object.\n * @memberOf Utils\n */\nlunr.utils.asString = function (obj) {\n  if (obj === void 0 || obj === null) {\n    return \"\"\n  } else {\n    return obj.toString()\n  }\n}\n/*!\n * lunr.EventEmitter\n * Copyright (C) 2017 Oliver Nightingale\n */\n\n/**\n * lunr.EventEmitter is an event emitter for lunr. It manages adding and removing event handlers and triggering events and their handlers.\n *\n * @constructor\n */\nlunr.EventEmitter = function () {\n  this.events = {}\n}\n\n/**\n * Binds a handler function to a specific event(s).\n *\n * Can bind a single function to many different events in one call.\n *\n * @param {String} [eventName] The name(s) of events to bind this function to.\n * @param {Function} fn The function to call when an event is fired.\n * @memberOf EventEmitter\n */\nlunr.EventEmitter.prototype.addListener = function () {\n  var args = Array.prototype.slice.call(arguments),\n      fn = args.pop(),\n      names = args\n\n  if (typeof fn !== \"function\") throw new TypeError (\"last argument must be a function\")\n\n  names.forEach(function (name) {\n    if (!this.hasHandler(name)) this.events[name] = []\n    this.events[name].push(fn)\n  }, this)\n}\n\n/**\n * Removes a handler function from a specific event.\n *\n * @param {String} eventName The name of the event to remove this function from.\n * @param {Function} fn The function to remove from an event.\n * @memberOf EventEmitter\n */\nlunr.EventEmitter.prototype.removeListener = function (name, fn) {\n  if (!this.hasHandler(name)) return\n\n  var fnIndex = this.events[name].indexOf(fn)\n  this.events[name].splice(fnIndex, 1)\n\n  if (!this.events[name].length) delete this.events[name]\n}\n\n/**\n * Calls all functions bound to the given event.\n *\n * Additional data can be passed to the event handler as arguments to `emit`\n * after the event name.\n *\n * @param {String} eventName The name of the event to emit.\n * @memberOf EventEmitter\n */\nlunr.EventEmitter.prototype.emit = function (name) {\n  if (!this.hasHandler(name)) return\n\n  var args = Array.prototype.slice.call(arguments, 1)\n\n  this.events[name].forEach(function (fn) {\n    fn.apply(undefined, args)\n  })\n}\n\n/**\n * Checks whether a handler has ever been stored against an event.\n *\n * @param {String} eventName The name of the event to check.\n * @private\n * @memberOf EventEmitter\n */\nlunr.EventEmitter.prototype.hasHandler = function (name) {\n  return name in this.events\n}\n\n/*!\n * lunr.tokenizer\n * Copyright (C) 2017 Oliver Nightingale\n */\n\n/**\n * A function for splitting a string into tokens ready to be inserted into\n * the search index. Uses `lunr.tokenizer.separator` to split strings, change\n * the value of this property to change how strings are split into tokens.\n *\n * @module\n * @param {String} obj The string to convert into tokens\n * @see lunr.tokenizer.separator\n * @returns {Array}\n */\nlunr.tokenizer = function (obj) {\n  if (!arguments.length || obj == null || obj == undefined) return []\n  if (Array.isArray(obj)) return obj.map(function (t) { return lunr.utils.asString(t).toLowerCase() })\n\n  return obj.toString().trim().toLowerCase().split(lunr.tokenizer.separator)\n}\n\n/**\n * The sperator used to split a string into tokens. Override this property to change the behaviour of\n * `lunr.tokenizer` behaviour when tokenizing strings. By default this splits on whitespace and hyphens.\n *\n * @static\n * @see lunr.tokenizer\n */\nlunr.tokenizer.separator = /[\\s\\-]+/\n\n/**\n * Loads a previously serialised tokenizer.\n *\n * A tokenizer function to be loaded must already be registered with lunr.tokenizer.\n * If the serialised tokenizer has not been registered then an error will be thrown.\n *\n * @param {String} label The label of the serialised tokenizer.\n * @returns {Function}\n * @memberOf tokenizer\n */\nlunr.tokenizer.load = function (label) {\n  var fn = this.registeredFunctions[label]\n\n  if (!fn) {\n    throw new Error('Cannot load un-registered function: ' + label)\n  }\n\n  return fn\n}\n\nlunr.tokenizer.label = 'default'\n\nlunr.tokenizer.registeredFunctions = {\n  'default': lunr.tokenizer\n}\n\n/**\n * Register a tokenizer function.\n *\n * Functions that are used as tokenizers should be registered if they are to be used with a serialised index.\n *\n * Registering a function does not add it to an index, functions must still be associated with a specific index for them to be used when indexing and searching documents.\n *\n * @param {Function} fn The function to register.\n * @param {String} label The label to register this function with\n * @memberOf tokenizer\n */\nlunr.tokenizer.registerFunction = function (fn, label) {\n  if (label in this.registeredFunctions) {\n    lunr.utils.warn('Overwriting existing tokenizer: ' + label)\n  }\n\n  fn.label = label\n  this.registeredFunctions[label] = fn\n}\n/*!\n * lunr.Pipeline\n * Copyright (C) 2017 Oliver Nightingale\n */\n\n/**\n * lunr.Pipelines maintain an ordered list of functions to be applied to all\n * tokens in documents entering the search index and queries being ran against\n * the index.\n *\n * An instance of lunr.Index created with the lunr shortcut will contain a\n * pipeline with a stop word filter and an English language stemmer. Extra\n * functions can be added before or after either of these functions or these\n * default functions can be removed.\n *\n * When run the pipeline will call each function in turn, passing a token, the\n * index of that token in the original list of all tokens and finally a list of\n * all the original tokens.\n *\n * The output of functions in the pipeline will be passed to the next function\n * in the pipeline. To exclude a token from entering the index the function\n * should return undefined, the rest of the pipeline will not be called with\n * this token.\n *\n * For serialisation of pipelines to work, all functions used in an instance of\n * a pipeline should be registered with lunr.Pipeline. Registered functions can\n * then be loaded. If trying to load a serialised pipeline that uses functions\n * that are not registered an error will be thrown.\n *\n * If not planning on serialising the pipeline then registering pipeline functions\n * is not necessary.\n *\n * @constructor\n */\nlunr.Pipeline = function () {\n  this._stack = []\n}\n\nlunr.Pipeline.registeredFunctions = {}\n\n/**\n * Register a function with the pipeline.\n *\n * Functions that are used in the pipeline should be registered if the pipeline\n * needs to be serialised, or a serialised pipeline needs to be loaded.\n *\n * Registering a function does not add it to a pipeline, functions must still be\n * added to instances of the pipeline for them to be used when running a pipeline.\n *\n * @param {Function} fn The function to check for.\n * @param {String} label The label to register this function with\n * @memberOf Pipeline\n */\nlunr.Pipeline.registerFunction = function (fn, label) {\n  if (label in this.registeredFunctions) {\n    lunr.utils.warn('Overwriting existing registered function: ' + label)\n  }\n\n  fn.label = label\n  lunr.Pipeline.registeredFunctions[fn.label] = fn\n}\n\n/**\n * Warns if the function is not registered as a Pipeline function.\n *\n * @param {Function} fn The function to check for.\n * @private\n * @memberOf Pipeline\n */\nlunr.Pipeline.warnIfFunctionNotRegistered = function (fn) {\n  var isRegistered = fn.label && (fn.label in this.registeredFunctions)\n\n  if (!isRegistered) {\n    lunr.utils.warn('Function is not registered with pipeline. This may cause problems when serialising the index.\\n', fn)\n  }\n}\n\n/**\n * Loads a previously serialised pipeline.\n *\n * All functions to be loaded must already be registered with lunr.Pipeline.\n * If any function from the serialised data has not been registered then an\n * error will be thrown.\n *\n * @param {Object} serialised The serialised pipeline to load.\n * @returns {lunr.Pipeline}\n * @memberOf Pipeline\n */\nlunr.Pipeline.load = function (serialised) {\n  var pipeline = new lunr.Pipeline\n\n  serialised.forEach(function (fnName) {\n    var fn = lunr.Pipeline.registeredFunctions[fnName]\n\n    if (fn) {\n      pipeline.add(fn)\n    } else {\n      throw new Error('Cannot load un-registered function: ' + fnName)\n    }\n  })\n\n  return pipeline\n}\n\n/**\n * Adds new functions to the end of the pipeline.\n *\n * Logs a warning if the function has not been registered.\n *\n * @param {Function} functions Any number of functions to add to the pipeline.\n * @memberOf Pipeline\n */\nlunr.Pipeline.prototype.add = function () {\n  var fns = Array.prototype.slice.call(arguments)\n\n  fns.forEach(function (fn) {\n    lunr.Pipeline.warnIfFunctionNotRegistered(fn)\n    this._stack.push(fn)\n  }, this)\n}\n\n/**\n * Adds a single function after a function that already exists in the\n * pipeline.\n *\n * Logs a warning if the function has not been registered.\n *\n * @param {Function} existingFn A function that already exists in the pipeline.\n * @param {Function} newFn The new function to add to the pipeline.\n * @memberOf Pipeline\n */\nlunr.Pipeline.prototype.after = function (existingFn, newFn) {\n  lunr.Pipeline.warnIfFunctionNotRegistered(newFn)\n\n  var pos = this._stack.indexOf(existingFn)\n  if (pos == -1) {\n    throw new Error('Cannot find existingFn')\n  }\n\n  pos = pos + 1\n  this._stack.splice(pos, 0, newFn)\n}\n\n/**\n * Adds a single function before a function that already exists in the\n * pipeline.\n *\n * Logs a warning if the function has not been registered.\n *\n * @param {Function} existingFn A function that already exists in the pipeline.\n * @param {Function} newFn The new function to add to the pipeline.\n * @memberOf Pipeline\n */\nlunr.Pipeline.prototype.before = function (existingFn, newFn) {\n  lunr.Pipeline.warnIfFunctionNotRegistered(newFn)\n\n  var pos = this._stack.indexOf(existingFn)\n  if (pos == -1) {\n    throw new Error('Cannot find existingFn')\n  }\n\n  this._stack.splice(pos, 0, newFn)\n}\n\n/**\n * Removes a function from the pipeline.\n *\n * @param {Function} fn The function to remove from the pipeline.\n * @memberOf Pipeline\n */\nlunr.Pipeline.prototype.remove = function (fn) {\n  var pos = this._stack.indexOf(fn)\n  if (pos == -1) {\n    return\n  }\n\n  this._stack.splice(pos, 1)\n}\n\n/**\n * Runs the current list of functions that make up the pipeline against the\n * passed tokens.\n *\n * @param {Array} tokens The tokens to run through the pipeline.\n * @returns {Array}\n * @memberOf Pipeline\n */\nlunr.Pipeline.prototype.run = function (tokens) {\n  var out = [],\n      tokenLength = tokens.length,\n      stackLength = this._stack.length\n\n  for (var i = 0; i < tokenLength; i++) {\n    var token = tokens[i]\n\n    for (var j = 0; j < stackLength; j++) {\n      token = this._stack[j](token, i, tokens)\n      if (token === void 0 || token === '') break\n    };\n\n    if (token !== void 0 && token !== '') out.push(token)\n  };\n\n  return out\n}\n\n/**\n * Resets the pipeline by removing any existing processors.\n *\n * @memberOf Pipeline\n */\nlunr.Pipeline.prototype.reset = function () {\n  this._stack = []\n}\n\n/**\n * Returns a representation of the pipeline ready for serialisation.\n *\n * Logs a warning if the function has not been registered.\n *\n * @returns {Array}\n * @memberOf Pipeline\n */\nlunr.Pipeline.prototype.toJSON = function () {\n  return this._stack.map(function (fn) {\n    lunr.Pipeline.warnIfFunctionNotRegistered(fn)\n\n    return fn.label\n  })\n}\n/*!\n * lunr.Vector\n * Copyright (C) 2017 Oliver Nightingale\n */\n\n/**\n * lunr.Vectors implement vector related operations for\n * a series of elements.\n *\n * @constructor\n */\nlunr.Vector = function () {\n  this._magnitude = null\n  this.list = undefined\n  this.length = 0\n}\n\n/**\n * lunr.Vector.Node is a simple struct for each node\n * in a lunr.Vector.\n *\n * @private\n * @param {Number} The index of the node in the vector.\n * @param {Object} The data at this node in the vector.\n * @param {lunr.Vector.Node} The node directly after this node in the vector.\n * @constructor\n * @memberOf Vector\n */\nlunr.Vector.Node = function (idx, val, next) {\n  this.idx = idx\n  this.val = val\n  this.next = next\n}\n\n/**\n * Inserts a new value at a position in a vector.\n *\n * @param {Number} The index at which to insert a value.\n * @param {Object} The object to insert in the vector.\n * @memberOf Vector.\n */\nlunr.Vector.prototype.insert = function (idx, val) {\n  this._magnitude = undefined;\n  var list = this.list\n\n  if (!list) {\n    this.list = new lunr.Vector.Node (idx, val, list)\n    return this.length++\n  }\n\n  if (idx < list.idx) {\n    this.list = new lunr.Vector.Node (idx, val, list)\n    return this.length++\n  }\n\n  var prev = list,\n      next = list.next\n\n  while (next != undefined) {\n    if (idx < next.idx) {\n      prev.next = new lunr.Vector.Node (idx, val, next)\n      return this.length++\n    }\n\n    prev = next, next = next.next\n  }\n\n  prev.next = new lunr.Vector.Node (idx, val, next)\n  return this.length++\n}\n\n/**\n * Calculates the magnitude of this vector.\n *\n * @returns {Number}\n * @memberOf Vector\n */\nlunr.Vector.prototype.magnitude = function () {\n  if (this._magnitude) return this._magnitude\n  var node = this.list,\n      sumOfSquares = 0,\n      val\n\n  while (node) {\n    val = node.val\n    sumOfSquares += val * val\n    node = node.next\n  }\n\n  return this._magnitude = Math.sqrt(sumOfSquares)\n}\n\n/**\n * Calculates the dot product of this vector and another vector.\n *\n * @param {lunr.Vector} otherVector The vector to compute the dot product with.\n * @returns {Number}\n * @memberOf Vector\n */\nlunr.Vector.prototype.dot = function (otherVector) {\n  var node = this.list,\n      otherNode = otherVector.list,\n      dotProduct = 0\n\n  while (node && otherNode) {\n    if (node.idx < otherNode.idx) {\n      node = node.next\n    } else if (node.idx > otherNode.idx) {\n      otherNode = otherNode.next\n    } else {\n      dotProduct += node.val * otherNode.val\n      node = node.next\n      otherNode = otherNode.next\n    }\n  }\n\n  return dotProduct\n}\n\n/**\n * Calculates the cosine similarity between this vector and another\n * vector.\n *\n * @param {lunr.Vector} otherVector The other vector to calculate the\n * similarity with.\n * @returns {Number}\n * @memberOf Vector\n */\nlunr.Vector.prototype.similarity = function (otherVector) {\n  return this.dot(otherVector) / (this.magnitude() * otherVector.magnitude())\n}\n/*!\n * lunr.SortedSet\n * Copyright (C) 2017 Oliver Nightingale\n */\n\n/**\n * lunr.SortedSets are used to maintain an array of uniq values in a sorted\n * order.\n *\n * @constructor\n */\nlunr.SortedSet = function () {\n  this.length = 0\n  this.elements = []\n}\n\n/**\n * Loads a previously serialised sorted set.\n *\n * @param {Array} serialisedData The serialised set to load.\n * @returns {lunr.SortedSet}\n * @memberOf SortedSet\n */\nlunr.SortedSet.load = function (serialisedData) {\n  var set = new this\n\n  set.elements = serialisedData\n  set.length = serialisedData.length\n\n  return set\n}\n\n/**\n * Inserts new items into the set in the correct position to maintain the\n * order.\n *\n * @param {Object} The objects to add to this set.\n * @memberOf SortedSet\n */\nlunr.SortedSet.prototype.add = function () {\n  var i, element\n\n  for (i = 0; i < arguments.length; i++) {\n    element = arguments[i]\n    if (~this.indexOf(element)) continue\n    this.elements.splice(this.locationFor(element), 0, element)\n  }\n\n  this.length = this.elements.length\n}\n\n/**\n * Converts this sorted set into an array.\n *\n * @returns {Array}\n * @memberOf SortedSet\n */\nlunr.SortedSet.prototype.toArray = function () {\n  return this.elements.slice()\n}\n\n/**\n * Creates a new array with the results of calling a provided function on every\n * element in this sorted set.\n *\n * Delegates to Array.prototype.map and has the same signature.\n *\n * @param {Function} fn The function that is called on each element of the\n * set.\n * @param {Object} ctx An optional object that can be used as the context\n * for the function fn.\n * @returns {Array}\n * @memberOf SortedSet\n */\nlunr.SortedSet.prototype.map = function (fn, ctx) {\n  return this.elements.map(fn, ctx)\n}\n\n/**\n * Executes a provided function once per sorted set element.\n *\n * Delegates to Array.prototype.forEach and has the same signature.\n *\n * @param {Function} fn The function that is called on each element of the\n * set.\n * @param {Object} ctx An optional object that can be used as the context\n * @memberOf SortedSet\n * for the function fn.\n */\nlunr.SortedSet.prototype.forEach = function (fn, ctx) {\n  return this.elements.forEach(fn, ctx)\n}\n\n/**\n * Returns the index at which a given element can be found in the\n * sorted set, or -1 if it is not present.\n *\n * @param {Object} elem The object to locate in the sorted set.\n * @returns {Number}\n * @memberOf SortedSet\n */\nlunr.SortedSet.prototype.indexOf = function (elem) {\n  var start = 0,\n      end = this.elements.length,\n      sectionLength = end - start,\n      pivot = start + Math.floor(sectionLength / 2),\n      pivotElem = this.elements[pivot]\n\n  while (sectionLength > 1) {\n    if (pivotElem === elem) return pivot\n\n    if (pivotElem < elem) start = pivot\n    if (pivotElem > elem) end = pivot\n\n    sectionLength = end - start\n    pivot = start + Math.floor(sectionLength / 2)\n    pivotElem = this.elements[pivot]\n  }\n\n  if (pivotElem === elem) return pivot\n\n  return -1\n}\n\n/**\n * Returns the position within the sorted set that an element should be\n * inserted at to maintain the current order of the set.\n *\n * This function assumes that the element to search for does not already exist\n * in the sorted set.\n *\n * @param {Object} elem The elem to find the position for in the set\n * @returns {Number}\n * @memberOf SortedSet\n */\nlunr.SortedSet.prototype.locationFor = function (elem) {\n  var start = 0,\n      end = this.elements.length,\n      sectionLength = end - start,\n      pivot = start + Math.floor(sectionLength / 2),\n      pivotElem = this.elements[pivot]\n\n  while (sectionLength > 1) {\n    if (pivotElem < elem) start = pivot\n    if (pivotElem > elem) end = pivot\n\n    sectionLength = end - start\n    pivot = start + Math.floor(sectionLength / 2)\n    pivotElem = this.elements[pivot]\n  }\n\n  if (pivotElem > elem) return pivot\n  if (pivotElem < elem) return pivot + 1\n}\n\n/**\n * Creates a new lunr.SortedSet that contains the elements in the intersection\n * of this set and the passed set.\n *\n * @param {lunr.SortedSet} otherSet The set to intersect with this set.\n * @returns {lunr.SortedSet}\n * @memberOf SortedSet\n */\nlunr.SortedSet.prototype.intersect = function (otherSet) {\n  var intersectSet = new lunr.SortedSet,\n      i = 0, j = 0,\n      a_len = this.length, b_len = otherSet.length,\n      a = this.elements, b = otherSet.elements\n\n  while (true) {\n    if (i > a_len - 1 || j > b_len - 1) break\n\n    if (a[i] === b[j]) {\n      intersectSet.add(a[i])\n      i++, j++\n      continue\n    }\n\n    if (a[i] < b[j]) {\n      i++\n      continue\n    }\n\n    if (a[i] > b[j]) {\n      j++\n      continue\n    }\n  };\n\n  return intersectSet\n}\n\n/**\n * Makes a copy of this set\n *\n * @returns {lunr.SortedSet}\n * @memberOf SortedSet\n */\nlunr.SortedSet.prototype.clone = function () {\n  var clone = new lunr.SortedSet\n\n  clone.elements = this.toArray()\n  clone.length = clone.elements.length\n\n  return clone\n}\n\n/**\n * Creates a new lunr.SortedSet that contains the elements in the union\n * of this set and the passed set.\n *\n * @param {lunr.SortedSet} otherSet The set to union with this set.\n * @returns {lunr.SortedSet}\n * @memberOf SortedSet\n */\nlunr.SortedSet.prototype.union = function (otherSet) {\n  var longSet, shortSet, unionSet\n\n  if (this.length >= otherSet.length) {\n    longSet = this, shortSet = otherSet\n  } else {\n    longSet = otherSet, shortSet = this\n  }\n\n  unionSet = longSet.clone()\n\n  for(var i = 0, shortSetElements = shortSet.toArray(); i < shortSetElements.length; i++){\n    unionSet.add(shortSetElements[i])\n  }\n\n  return unionSet\n}\n\n/**\n * Returns a representation of the sorted set ready for serialisation.\n *\n * @returns {Array}\n * @memberOf SortedSet\n */\nlunr.SortedSet.prototype.toJSON = function () {\n  return this.toArray()\n}\n/*!\n * lunr.Index\n * Copyright (C) 2017 Oliver Nightingale\n */\n\n/**\n * lunr.Index is object that manages a search index.  It contains the indexes\n * and stores all the tokens and document lookups.  It also provides the main\n * user facing API for the library.\n *\n * @constructor\n */\nlunr.Index = function () {\n  this._fields = []\n  this._ref = 'id'\n  this.pipeline = new lunr.Pipeline\n  this.documentStore = new lunr.Store\n  this.tokenStore = new lunr.TokenStore\n  this.corpusTokens = new lunr.SortedSet\n  this.eventEmitter =  new lunr.EventEmitter\n  this.tokenizerFn = lunr.tokenizer\n\n  this._idfCache = {}\n\n  this.on('add', 'remove', 'update', (function () {\n    this._idfCache = {}\n  }).bind(this))\n}\n\n/**\n * Bind a handler to events being emitted by the index.\n *\n * The handler can be bound to many events at the same time.\n *\n * @param {String} [eventName] The name(s) of events to bind the function to.\n * @param {Function} fn The serialised set to load.\n * @memberOf Index\n */\nlunr.Index.prototype.on = function () {\n  var args = Array.prototype.slice.call(arguments)\n  return this.eventEmitter.addListener.apply(this.eventEmitter, args)\n}\n\n/**\n * Removes a handler from an event being emitted by the index.\n *\n * @param {String} eventName The name of events to remove the function from.\n * @param {Function} fn The serialised set to load.\n * @memberOf Index\n */\nlunr.Index.prototype.off = function (name, fn) {\n  return this.eventEmitter.removeListener(name, fn)\n}\n\n/**\n * Loads a previously serialised index.\n *\n * Issues a warning if the index being imported was serialised\n * by a different version of lunr.\n *\n * @param {Object} serialisedData The serialised set to load.\n * @returns {lunr.Index}\n * @memberOf Index\n */\nlunr.Index.load = function (serialisedData) {\n  if (serialisedData.version !== lunr.version) {\n    lunr.utils.warn('version mismatch: current ' + lunr.version + ' importing ' + serialisedData.version)\n  }\n\n  var idx = new this\n\n  idx._fields = serialisedData.fields\n  idx._ref = serialisedData.ref\n\n  idx.tokenizer(lunr.tokenizer.load(serialisedData.tokenizer))\n  idx.documentStore = lunr.Store.load(serialisedData.documentStore)\n  idx.tokenStore = lunr.TokenStore.load(serialisedData.tokenStore)\n  idx.corpusTokens = lunr.SortedSet.load(serialisedData.corpusTokens)\n  idx.pipeline = lunr.Pipeline.load(serialisedData.pipeline)\n\n  return idx\n}\n\n/**\n * Adds a field to the list of fields that will be searchable within documents\n * in the index.\n *\n * An optional boost param can be passed to affect how much tokens in this field\n * rank in search results, by default the boost value is 1.\n *\n * Fields should be added before any documents are added to the index, fields\n * that are added after documents are added to the index will only apply to new\n * documents added to the index.\n *\n * @param {String} fieldName The name of the field within the document that\n * should be indexed\n * @param {Number} boost An optional boost that can be applied to terms in this\n * field.\n * @returns {lunr.Index}\n * @memberOf Index\n */\nlunr.Index.prototype.field = function (fieldName, opts) {\n  var opts = opts || {},\n      field = { name: fieldName, boost: opts.boost || 1 }\n\n  this._fields.push(field)\n  return this\n}\n\n/**\n * Sets the property used to uniquely identify documents added to the index,\n * by default this property is 'id'.\n *\n * This should only be changed before adding documents to the index, changing\n * the ref property without resetting the index can lead to unexpected results.\n *\n * The value of ref can be of any type but it _must_ be stably comparable and\n * orderable.\n *\n * @param {String} refName The property to use to uniquely identify the\n * documents in the index.\n * @param {Boolean} emitEvent Whether to emit add events, defaults to true\n * @returns {lunr.Index}\n * @memberOf Index\n */\nlunr.Index.prototype.ref = function (refName) {\n  this._ref = refName\n  return this\n}\n\n/**\n * Sets the tokenizer used for this index.\n *\n * By default the index will use the default tokenizer, lunr.tokenizer. The tokenizer\n * should only be changed before adding documents to the index. Changing the tokenizer\n * without re-building the index can lead to unexpected results.\n *\n * @param {Function} fn The function to use as a tokenizer.\n * @returns {lunr.Index}\n * @memberOf Index\n */\nlunr.Index.prototype.tokenizer = function (fn) {\n  var isRegistered = fn.label && (fn.label in lunr.tokenizer.registeredFunctions)\n\n  if (!isRegistered) {\n    lunr.utils.warn('Function is not a registered tokenizer. This may cause problems when serialising the index')\n  }\n\n  this.tokenizerFn = fn\n  return this\n}\n\n/**\n * Add a document to the index.\n *\n * This is the way new documents enter the index, this function will run the\n * fields from the document through the index's pipeline and then add it to\n * the index, it will then show up in search results.\n *\n * An 'add' event is emitted with the document that has been added and the index\n * the document has been added to. This event can be silenced by passing false\n * as the second argument to add.\n *\n * @param {Object} doc The document to add to the index.\n * @param {Boolean} emitEvent Whether or not to emit events, default true.\n * @memberOf Index\n */\nlunr.Index.prototype.add = function (doc, emitEvent) {\n  var docTokens = {},\n      allDocumentTokens = new lunr.SortedSet,\n      docRef = doc[this._ref],\n      emitEvent = emitEvent === undefined ? true : emitEvent\n\n  this._fields.forEach(function (field) {\n    var fieldTokens = this.pipeline.run(this.tokenizerFn(doc[field.name]))\n\n    docTokens[field.name] = fieldTokens\n\n    for (var i = 0; i < fieldTokens.length; i++) {\n      var token = fieldTokens[i]\n      allDocumentTokens.add(token)\n      this.corpusTokens.add(token)\n    }\n  }, this)\n\n  this.documentStore.set(docRef, allDocumentTokens)\n\n  for (var i = 0; i < allDocumentTokens.length; i++) {\n    var token = allDocumentTokens.elements[i]\n    var tf = 0;\n\n    for (var j = 0; j < this._fields.length; j++){\n      var field = this._fields[j]\n      var fieldTokens = docTokens[field.name]\n      var fieldLength = fieldTokens.length\n\n      if (!fieldLength) continue\n\n      var tokenCount = 0\n      for (var k = 0; k < fieldLength; k++){\n        if (fieldTokens[k] === token){\n          tokenCount++\n        }\n      }\n\n      tf += (tokenCount / fieldLength * field.boost)\n    }\n\n    this.tokenStore.add(token, { ref: docRef, tf: tf })\n  };\n\n  if (emitEvent) this.eventEmitter.emit('add', doc, this)\n}\n\n/**\n * Removes a document from the index.\n *\n * To make sure documents no longer show up in search results they can be\n * removed from the index using this method.\n *\n * The document passed only needs to have the same ref property value as the\n * document that was added to the index, they could be completely different\n * objects.\n *\n * A 'remove' event is emitted with the document that has been removed and the index\n * the document has been removed from. This event can be silenced by passing false\n * as the second argument to remove.\n *\n * @param {Object} doc The document to remove from the index.\n * @param {Boolean} emitEvent Whether to emit remove events, defaults to true\n * @memberOf Index\n */\nlunr.Index.prototype.remove = function (doc, emitEvent) {\n  var docRef = doc[this._ref],\n      emitEvent = emitEvent === undefined ? true : emitEvent\n\n  if (!this.documentStore.has(docRef)) return\n\n  var docTokens = this.documentStore.get(docRef)\n\n  this.documentStore.remove(docRef)\n\n  docTokens.forEach(function (token) {\n    this.tokenStore.remove(token, docRef)\n  }, this)\n\n  if (emitEvent) this.eventEmitter.emit('remove', doc, this)\n}\n\n/**\n * Updates a document in the index.\n *\n * When a document contained within the index gets updated, fields changed,\n * added or removed, to make sure it correctly matched against search queries,\n * it should be updated in the index.\n *\n * This method is just a wrapper around `remove` and `add`\n *\n * An 'update' event is emitted with the document that has been updated and the index.\n * This event can be silenced by passing false as the second argument to update. Only\n * an update event will be fired, the 'add' and 'remove' events of the underlying calls\n * are silenced.\n *\n * @param {Object} doc The document to update in the index.\n * @param {Boolean} emitEvent Whether to emit update events, defaults to true\n * @see Index.prototype.remove\n * @see Index.prototype.add\n * @memberOf Index\n */\nlunr.Index.prototype.update = function (doc, emitEvent) {\n  var emitEvent = emitEvent === undefined ? true : emitEvent\n\n  this.remove(doc, false)\n  this.add(doc, false)\n\n  if (emitEvent) this.eventEmitter.emit('update', doc, this)\n}\n\n/**\n * Calculates the inverse document frequency for a token within the index.\n *\n * @param {String} token The token to calculate the idf of.\n * @see Index.prototype.idf\n * @private\n * @memberOf Index\n */\nlunr.Index.prototype.idf = function (term) {\n  var cacheKey = \"@\" + term\n  if (Object.prototype.hasOwnProperty.call(this._idfCache, cacheKey)) return this._idfCache[cacheKey]\n\n  var documentFrequency = this.tokenStore.count(term),\n      idf = 1\n\n  if (documentFrequency > 0) {\n    idf = 1 + Math.log(this.documentStore.length / documentFrequency)\n  }\n\n  return this._idfCache[cacheKey] = idf\n}\n\n/**\n * Searches the index using the passed query.\n *\n * Queries should be a string, multiple words are allowed and will lead to an\n * AND based query, e.g. `idx.search('foo bar')` will run a search for\n * documents containing both 'foo' and 'bar'.\n *\n * All query tokens are passed through the same pipeline that document tokens\n * are passed through, so any language processing involved will be run on every\n * query term.\n *\n * Each query term is expanded, so that the term 'he' might be expanded to\n * 'hello' and 'help' if those terms were already included in the index.\n *\n * Matching documents are returned as an array of objects, each object contains\n * the matching document ref, as set for this index, and the similarity score\n * for this document against the query.\n *\n * @param {String} query The query to search the index with.\n * @returns {Object}\n * @see Index.prototype.idf\n * @see Index.prototype.documentVector\n * @memberOf Index\n */\nlunr.Index.prototype.search = function (query) {\n  var queryTokens = this.pipeline.run(this.tokenizerFn(query)),\n      queryVector = new lunr.Vector,\n      documentSets = [],\n      fieldBoosts = this._fields.reduce(function (memo, f) { return memo + f.boost }, 0)\n\n  var hasSomeToken = queryTokens.some(function (token) {\n    return this.tokenStore.has(token)\n  }, this)\n\n  if (!hasSomeToken) return []\n\n  queryTokens\n    .forEach(function (token, i, tokens) {\n      var tf = 1 / tokens.length * this._fields.length * fieldBoosts,\n          self = this\n\n      var set = this.tokenStore.expand(token).reduce(function (memo, key) {\n        var pos = self.corpusTokens.indexOf(key),\n            idf = self.idf(key),\n            similarityBoost = 1,\n            set = new lunr.SortedSet\n\n        // if the expanded key is not an exact match to the token then\n        // penalise the score for this key by how different the key is\n        // to the token.\n        if (key !== token) {\n          var diff = Math.max(3, key.length - token.length)\n          similarityBoost = 1 / Math.log(diff)\n        }\n\n        // calculate the query tf-idf score for this token\n        // applying an similarityBoost to ensure exact matches\n        // these rank higher than expanded terms\n        if (pos > -1) queryVector.insert(pos, tf * idf * similarityBoost)\n\n        // add all the documents that have this key into a set\n        // ensuring that the type of key is preserved\n        var matchingDocuments = self.tokenStore.get(key),\n            refs = Object.keys(matchingDocuments),\n            refsLen = refs.length\n\n        for (var i = 0; i < refsLen; i++) {\n          set.add(matchingDocuments[refs[i]].ref)\n        }\n\n        return memo.union(set)\n      }, new lunr.SortedSet)\n\n      documentSets.push(set)\n    }, this)\n\n  var documentSet = documentSets.reduce(function (memo, set) {\n    return memo.intersect(set)\n  })\n\n  return documentSet\n    .map(function (ref) {\n      return { ref: ref, score: queryVector.similarity(this.documentVector(ref)) }\n    }, this)\n    .sort(function (a, b) {\n      return b.score - a.score\n    })\n}\n\n/**\n * Generates a vector containing all the tokens in the document matching the\n * passed documentRef.\n *\n * The vector contains the tf-idf score for each token contained in the\n * document with the passed documentRef.  The vector will contain an element\n * for every token in the indexes corpus, if the document does not contain that\n * token the element will be 0.\n *\n * @param {Object} documentRef The ref to find the document with.\n * @returns {lunr.Vector}\n * @private\n * @memberOf Index\n */\nlunr.Index.prototype.documentVector = function (documentRef) {\n  var documentTokens = this.documentStore.get(documentRef),\n      documentTokensLength = documentTokens.length,\n      documentVector = new lunr.Vector\n\n  for (var i = 0; i < documentTokensLength; i++) {\n    var token = documentTokens.elements[i],\n        tf = this.tokenStore.get(token)[documentRef].tf,\n        idf = this.idf(token)\n\n    documentVector.insert(this.corpusTokens.indexOf(token), tf * idf)\n  };\n\n  return documentVector\n}\n\n/**\n * Returns a representation of the index ready for serialisation.\n *\n * @returns {Object}\n * @memberOf Index\n */\nlunr.Index.prototype.toJSON = function () {\n  return {\n    version: lunr.version,\n    fields: this._fields,\n    ref: this._ref,\n    tokenizer: this.tokenizerFn.label,\n    documentStore: this.documentStore.toJSON(),\n    tokenStore: this.tokenStore.toJSON(),\n    corpusTokens: this.corpusTokens.toJSON(),\n    pipeline: this.pipeline.toJSON()\n  }\n}\n\n/**\n * Applies a plugin to the current index.\n *\n * A plugin is a function that is called with the index as its context.\n * Plugins can be used to customise or extend the behaviour the index\n * in some way. A plugin is just a function, that encapsulated the custom\n * behaviour that should be applied to the index.\n *\n * The plugin function will be called with the index as its argument, additional\n * arguments can also be passed when calling use. The function will be called\n * with the index as its context.\n *\n * Example:\n *\n *     var myPlugin = function (idx, arg1, arg2) {\n *       // `this` is the index to be extended\n *       // apply any extensions etc here.\n *     }\n *\n *     var idx = lunr(function () {\n *       this.use(myPlugin, 'arg1', 'arg2')\n *     })\n *\n * @param {Function} plugin The plugin to apply.\n * @memberOf Index\n */\nlunr.Index.prototype.use = function (plugin) {\n  var args = Array.prototype.slice.call(arguments, 1)\n  args.unshift(this)\n  plugin.apply(this, args)\n}\n/*!\n * lunr.Store\n * Copyright (C) 2017 Oliver Nightingale\n */\n\n/**\n * lunr.Store is a simple key-value store used for storing sets of tokens for\n * documents stored in index.\n *\n * @constructor\n * @module\n */\nlunr.Store = function () {\n  this.store = {}\n  this.length = 0\n}\n\n/**\n * Loads a previously serialised store\n *\n * @param {Object} serialisedData The serialised store to load.\n * @returns {lunr.Store}\n * @memberOf Store\n */\nlunr.Store.load = function (serialisedData) {\n  var store = new this\n\n  store.length = serialisedData.length\n  store.store = Object.keys(serialisedData.store).reduce(function (memo, key) {\n    memo[key] = lunr.SortedSet.load(serialisedData.store[key])\n    return memo\n  }, {})\n\n  return store\n}\n\n/**\n * Stores the given tokens in the store against the given id.\n *\n * @param {Object} id The key used to store the tokens against.\n * @param {Object} tokens The tokens to store against the key.\n * @memberOf Store\n */\nlunr.Store.prototype.set = function (id, tokens) {\n  if (!this.has(id)) this.length++\n  this.store[id] = tokens\n}\n\n/**\n * Retrieves the tokens from the store for a given key.\n *\n * @param {Object} id The key to lookup and retrieve from the store.\n * @returns {Object}\n * @memberOf Store\n */\nlunr.Store.prototype.get = function (id) {\n  return this.store[id]\n}\n\n/**\n * Checks whether the store contains a key.\n *\n * @param {Object} id The id to look up in the store.\n * @returns {Boolean}\n * @memberOf Store\n */\nlunr.Store.prototype.has = function (id) {\n  return id in this.store\n}\n\n/**\n * Removes the value for a key in the store.\n *\n * @param {Object} id The id to remove from the store.\n * @memberOf Store\n */\nlunr.Store.prototype.remove = function (id) {\n  if (!this.has(id)) return\n\n  delete this.store[id]\n  this.length--\n}\n\n/**\n * Returns a representation of the store ready for serialisation.\n *\n * @returns {Object}\n * @memberOf Store\n */\nlunr.Store.prototype.toJSON = function () {\n  return {\n    store: this.store,\n    length: this.length\n  }\n}\n\n/*!\n * lunr.stemmer\n * Copyright (C) 2017 Oliver Nightingale\n * Includes code from - http://tartarus.org/~martin/PorterStemmer/js.txt\n */\n\n/**\n * lunr.stemmer is an english language stemmer, this is a JavaScript\n * implementation of the PorterStemmer taken from http://tartarus.org/~martin\n *\n * @module\n * @param {String} str The string to stem\n * @returns {String}\n * @see lunr.Pipeline\n */\nlunr.stemmer = (function(){\n  var step2list = {\n      \"ational\" : \"ate\",\n      \"tional\" : \"tion\",\n      \"enci\" : \"ence\",\n      \"anci\" : \"ance\",\n      \"izer\" : \"ize\",\n      \"bli\" : \"ble\",\n      \"alli\" : \"al\",\n      \"entli\" : \"ent\",\n      \"eli\" : \"e\",\n      \"ousli\" : \"ous\",\n      \"ization\" : \"ize\",\n      \"ation\" : \"ate\",\n      \"ator\" : \"ate\",\n      \"alism\" : \"al\",\n      \"iveness\" : \"ive\",\n      \"fulness\" : \"ful\",\n      \"ousness\" : \"ous\",\n      \"aliti\" : \"al\",\n      \"iviti\" : \"ive\",\n      \"biliti\" : \"ble\",\n      \"logi\" : \"log\"\n    },\n\n    step3list = {\n      \"icate\" : \"ic\",\n      \"ative\" : \"\",\n      \"alize\" : \"al\",\n      \"iciti\" : \"ic\",\n      \"ical\" : \"ic\",\n      \"ful\" : \"\",\n      \"ness\" : \"\"\n    },\n\n    c = \"[^aeiou]\",          // consonant\n    v = \"[aeiouy]\",          // vowel\n    C = c + \"[^aeiouy]*\",    // consonant sequence\n    V = v + \"[aeiou]*\",      // vowel sequence\n\n    mgr0 = \"^(\" + C + \")?\" + V + C,               // [C]VC... is m>0\n    meq1 = \"^(\" + C + \")?\" + V + C + \"(\" + V + \")?$\",  // [C]VC[V] is m=1\n    mgr1 = \"^(\" + C + \")?\" + V + C + V + C,       // [C]VCVC... is m>1\n    s_v = \"^(\" + C + \")?\" + v;                   // vowel in stem\n\n  var re_mgr0 = new RegExp(mgr0);\n  var re_mgr1 = new RegExp(mgr1);\n  var re_meq1 = new RegExp(meq1);\n  var re_s_v = new RegExp(s_v);\n\n  var re_1a = /^(.+?)(ss|i)es$/;\n  var re2_1a = /^(.+?)([^s])s$/;\n  var re_1b = /^(.+?)eed$/;\n  var re2_1b = /^(.+?)(ed|ing)$/;\n  var re_1b_2 = /.$/;\n  var re2_1b_2 = /(at|bl|iz)$/;\n  var re3_1b_2 = new RegExp(\"([^aeiouylsz])\\\\1$\");\n  var re4_1b_2 = new RegExp(\"^\" + C + v + \"[^aeiouwxy]$\");\n\n  var re_1c = /^(.+?[^aeiou])y$/;\n  var re_2 = /^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/;\n\n  var re_3 = /^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/;\n\n  var re_4 = /^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/;\n  var re2_4 = /^(.+?)(s|t)(ion)$/;\n\n  var re_5 = /^(.+?)e$/;\n  var re_5_1 = /ll$/;\n  var re3_5 = new RegExp(\"^\" + C + v + \"[^aeiouwxy]$\");\n\n  var porterStemmer = function porterStemmer(w) {\n    var   stem,\n      suffix,\n      firstch,\n      re,\n      re2,\n      re3,\n      re4;\n\n    if (w.length < 3) { return w; }\n\n    firstch = w.substr(0,1);\n    if (firstch == \"y\") {\n      w = firstch.toUpperCase() + w.substr(1);\n    }\n\n    // Step 1a\n    re = re_1a\n    re2 = re2_1a;\n\n    if (re.test(w)) { w = w.replace(re,\"$1$2\"); }\n    else if (re2.test(w)) { w = w.replace(re2,\"$1$2\"); }\n\n    // Step 1b\n    re = re_1b;\n    re2 = re2_1b;\n    if (re.test(w)) {\n      var fp = re.exec(w);\n      re = re_mgr0;\n      if (re.test(fp[1])) {\n        re = re_1b_2;\n        w = w.replace(re,\"\");\n      }\n    } else if (re2.test(w)) {\n      var fp = re2.exec(w);\n      stem = fp[1];\n      re2 = re_s_v;\n      if (re2.test(stem)) {\n        w = stem;\n        re2 = re2_1b_2;\n        re3 = re3_1b_2;\n        re4 = re4_1b_2;\n        if (re2.test(w)) {  w = w + \"e\"; }\n        else if (re3.test(w)) { re = re_1b_2; w = w.replace(re,\"\"); }\n        else if (re4.test(w)) { w = w + \"e\"; }\n      }\n    }\n\n    // Step 1c - replace suffix y or Y by i if preceded by a non-vowel which is not the first letter of the word (so cry -> cri, by -> by, say -> say)\n    re = re_1c;\n    if (re.test(w)) {\n      var fp = re.exec(w);\n      stem = fp[1];\n      w = stem + \"i\";\n    }\n\n    // Step 2\n    re = re_2;\n    if (re.test(w)) {\n      var fp = re.exec(w);\n      stem = fp[1];\n      suffix = fp[2];\n      re = re_mgr0;\n      if (re.test(stem)) {\n        w = stem + step2list[suffix];\n      }\n    }\n\n    // Step 3\n    re = re_3;\n    if (re.test(w)) {\n      var fp = re.exec(w);\n      stem = fp[1];\n      suffix = fp[2];\n      re = re_mgr0;\n      if (re.test(stem)) {\n        w = stem + step3list[suffix];\n      }\n    }\n\n    // Step 4\n    re = re_4;\n    re2 = re2_4;\n    if (re.test(w)) {\n      var fp = re.exec(w);\n      stem = fp[1];\n      re = re_mgr1;\n      if (re.test(stem)) {\n        w = stem;\n      }\n    } else if (re2.test(w)) {\n      var fp = re2.exec(w);\n      stem = fp[1] + fp[2];\n      re2 = re_mgr1;\n      if (re2.test(stem)) {\n        w = stem;\n      }\n    }\n\n    // Step 5\n    re = re_5;\n    if (re.test(w)) {\n      var fp = re.exec(w);\n      stem = fp[1];\n      re = re_mgr1;\n      re2 = re_meq1;\n      re3 = re3_5;\n      if (re.test(stem) || (re2.test(stem) && !(re3.test(stem)))) {\n        w = stem;\n      }\n    }\n\n    re = re_5_1;\n    re2 = re_mgr1;\n    if (re.test(w) && re2.test(w)) {\n      re = re_1b_2;\n      w = w.replace(re,\"\");\n    }\n\n    // and turn initial Y back to y\n\n    if (firstch == \"y\") {\n      w = firstch.toLowerCase() + w.substr(1);\n    }\n\n    return w;\n  };\n\n  return porterStemmer;\n})();\n\nlunr.Pipeline.registerFunction(lunr.stemmer, 'stemmer')\n/*!\n * lunr.stopWordFilter\n * Copyright (C) 2017 Oliver Nightingale\n */\n\n/**\n * lunr.generateStopWordFilter builds a stopWordFilter function from the provided\n * list of stop words.\n *\n * The built in lunr.stopWordFilter is built using this generator and can be used\n * to generate custom stopWordFilters for applications or non English languages.\n *\n * @module\n * @param {Array} token The token to pass through the filter\n * @returns {Function}\n * @see lunr.Pipeline\n * @see lunr.stopWordFilter\n */\nlunr.generateStopWordFilter = function (stopWords) {\n  var words = stopWords.reduce(function (memo, stopWord) {\n    memo[stopWord] = stopWord\n    return memo\n  }, {})\n\n  return function (token) {\n    if (token && words[token] !== token) return token\n  }\n}\n\n/**\n * lunr.stopWordFilter is an English language stop word list filter, any words\n * contained in the list will not be passed through the filter.\n *\n * This is intended to be used in the Pipeline. If the token does not pass the\n * filter then undefined will be returned.\n *\n * @module\n * @param {String} token The token to pass through the filter\n * @returns {String}\n * @see lunr.Pipeline\n */\nlunr.stopWordFilter = lunr.generateStopWordFilter([\n  'a',\n  'able',\n  'about',\n  'across',\n  'after',\n  'all',\n  'almost',\n  'also',\n  'am',\n  'among',\n  'an',\n  'and',\n  'any',\n  'are',\n  'as',\n  'at',\n  'be',\n  'because',\n  'been',\n  'but',\n  'by',\n  'can',\n  'cannot',\n  'could',\n  'dear',\n  'did',\n  'do',\n  'does',\n  'either',\n  'else',\n  'ever',\n  'every',\n  'for',\n  'from',\n  'get',\n  'got',\n  'had',\n  'has',\n  'have',\n  'he',\n  'her',\n  'hers',\n  'him',\n  'his',\n  'how',\n  'however',\n  'i',\n  'if',\n  'in',\n  'into',\n  'is',\n  'it',\n  'its',\n  'just',\n  'least',\n  'let',\n  'like',\n  'likely',\n  'may',\n  'me',\n  'might',\n  'most',\n  'must',\n  'my',\n  'neither',\n  'no',\n  'nor',\n  'not',\n  'of',\n  'off',\n  'often',\n  'on',\n  'only',\n  'or',\n  'other',\n  'our',\n  'own',\n  'rather',\n  'said',\n  'say',\n  'says',\n  'she',\n  'should',\n  'since',\n  'so',\n  'some',\n  'than',\n  'that',\n  'the',\n  'their',\n  'them',\n  'then',\n  'there',\n  'these',\n  'they',\n  'this',\n  'tis',\n  'to',\n  'too',\n  'twas',\n  'us',\n  'wants',\n  'was',\n  'we',\n  'were',\n  'what',\n  'when',\n  'where',\n  'which',\n  'while',\n  'who',\n  'whom',\n  'why',\n  'will',\n  'with',\n  'would',\n  'yet',\n  'you',\n  'your'\n])\n\nlunr.Pipeline.registerFunction(lunr.stopWordFilter, 'stopWordFilter')\n/*!\n * lunr.trimmer\n * Copyright (C) 2017 Oliver Nightingale\n */\n\n/**\n * lunr.trimmer is a pipeline function for trimming non word\n * characters from the begining and end of tokens before they\n * enter the index.\n *\n * This implementation may not work correctly for non latin\n * characters and should either be removed or adapted for use\n * with languages with non-latin characters.\n *\n * @module\n * @param {String} token The token to pass through the filter\n * @returns {String}\n * @see lunr.Pipeline\n */\nlunr.trimmer = function (token) {\n  return token.replace(/^\\W+/, '').replace(/\\W+$/, '')\n}\n\nlunr.Pipeline.registerFunction(lunr.trimmer, 'trimmer')\n/*!\n * lunr.stemmer\n * Copyright (C) 2017 Oliver Nightingale\n * Includes code from - http://tartarus.org/~martin/PorterStemmer/js.txt\n */\n\n/**\n * lunr.TokenStore is used for efficient storing and lookup of the reverse\n * index of token to document ref.\n *\n * @constructor\n */\nlunr.TokenStore = function () {\n  this.root = { docs: {} }\n  this.length = 0\n}\n\n/**\n * Loads a previously serialised token store\n *\n * @param {Object} serialisedData The serialised token store to load.\n * @returns {lunr.TokenStore}\n * @memberOf TokenStore\n */\nlunr.TokenStore.load = function (serialisedData) {\n  var store = new this\n\n  store.root = serialisedData.root\n  store.length = serialisedData.length\n\n  return store\n}\n\n/**\n * Adds a new token doc pair to the store.\n *\n * By default this function starts at the root of the current store, however\n * it can start at any node of any token store if required.\n *\n * @param {String} token The token to store the doc under\n * @param {Object} doc The doc to store against the token\n * @param {Object} root An optional node at which to start looking for the\n * correct place to enter the doc, by default the root of this lunr.TokenStore\n * is used.\n * @memberOf TokenStore\n */\nlunr.TokenStore.prototype.add = function (token, doc, root) {\n  var root = root || this.root,\n      key = token.charAt(0),\n      rest = token.slice(1)\n\n  if (!(key in root)) root[key] = {docs: {}}\n\n  if (rest.length === 0) {\n    root[key].docs[doc.ref] = doc\n    this.length += 1\n    return\n  } else {\n    return this.add(rest, doc, root[key])\n  }\n}\n\n/**\n * Checks whether this key is contained within this lunr.TokenStore.\n *\n * By default this function starts at the root of the current store, however\n * it can start at any node of any token store if required.\n *\n * @param {String} token The token to check for\n * @param {Object} root An optional node at which to start\n * @memberOf TokenStore\n */\nlunr.TokenStore.prototype.has = function (token) {\n  if (!token) return false\n\n  var node = this.root\n\n  for (var i = 0; i < token.length; i++) {\n    if (!node[token.charAt(i)]) return false\n\n    node = node[token.charAt(i)]\n  }\n\n  return true\n}\n\n/**\n * Retrieve a node from the token store for a given token.\n *\n * By default this function starts at the root of the current store, however\n * it can start at any node of any token store if required.\n *\n * @param {String} token The token to get the node for.\n * @param {Object} root An optional node at which to start.\n * @returns {Object}\n * @see TokenStore.prototype.get\n * @memberOf TokenStore\n */\nlunr.TokenStore.prototype.getNode = function (token) {\n  if (!token) return {}\n\n  var node = this.root\n\n  for (var i = 0; i < token.length; i++) {\n    if (!node[token.charAt(i)]) return {}\n\n    node = node[token.charAt(i)]\n  }\n\n  return node\n}\n\n/**\n * Retrieve the documents for a node for the given token.\n *\n * By default this function starts at the root of the current store, however\n * it can start at any node of any token store if required.\n *\n * @param {String} token The token to get the documents for.\n * @param {Object} root An optional node at which to start.\n * @returns {Object}\n * @memberOf TokenStore\n */\nlunr.TokenStore.prototype.get = function (token, root) {\n  return this.getNode(token, root).docs || {}\n}\n\nlunr.TokenStore.prototype.count = function (token, root) {\n  return Object.keys(this.get(token, root)).length\n}\n\n/**\n * Remove the document identified by ref from the token in the store.\n *\n * By default this function starts at the root of the current store, however\n * it can start at any node of any token store if required.\n *\n * @param {String} token The token to get the documents for.\n * @param {String} ref The ref of the document to remove from this token.\n * @param {Object} root An optional node at which to start.\n * @returns {Object}\n * @memberOf TokenStore\n */\nlunr.TokenStore.prototype.remove = function (token, ref) {\n  if (!token) return\n  var node = this.root\n\n  for (var i = 0; i < token.length; i++) {\n    if (!(token.charAt(i) in node)) return\n    node = node[token.charAt(i)]\n  }\n\n  delete node.docs[ref]\n}\n\n/**\n * Find all the possible suffixes of the passed token using tokens\n * currently in the store.\n *\n * @param {String} token The token to expand.\n * @returns {Array}\n * @memberOf TokenStore\n */\nlunr.TokenStore.prototype.expand = function (token, memo) {\n  var root = this.getNode(token),\n      docs = root.docs || {},\n      memo = memo || []\n\n  if (Object.keys(docs).length) memo.push(token)\n\n  Object.keys(root)\n    .forEach(function (key) {\n      if (key === 'docs') return\n\n      memo.concat(this.expand(token + key, memo))\n    }, this)\n\n  return memo\n}\n\n/**\n * Returns a representation of the token store ready for serialisation.\n *\n * @returns {Object}\n * @memberOf TokenStore\n */\nlunr.TokenStore.prototype.toJSON = function () {\n  return {\n    root: this.root,\n    length: this.length\n  }\n}\n\n  /**\n   * export the module via AMD, CommonJS or as a browser global\n   * Export code from https://github.com/umdjs/umd/blob/master/returnExports.js\n   */\n  ;(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n      // AMD. Register as an anonymous module.\n      define(factory)\n    } else if (typeof exports === 'object') {\n      /**\n       * Node. Does not work with strict CommonJS, but\n       * only CommonJS-like enviroments that support module.exports,\n       * like Node.\n       */\n      module.exports = factory()\n    } else {\n      // Browser globals (root is window)\n      root.lunr = factory()\n    }\n  }(this, function () {\n    /**\n     * Just return a value to define the module export.\n     * This example returns an object, but the module\n     * can return a function as the exported value.\n     */\n    return lunr\n  }))\n})();\n\n\n\n// WEBPACK FOOTER //\n// ./~/lunr/lunr.js","import { setAttribute, getAttribute } from \"utils/elements\";\r\nimport { curry } from \"utils/functional\";\r\nimport { Eventful } from '../mixins/eventful';\r\nimport initPanel from \"components/panel\"\r\n\r\n/**\r\n * @constant {string}\r\n */\r\nconst ATTRIBUTE_CONTENT_TYPE_ID = 'data-id';\r\n\r\n/**\r\n * @function\r\n */\r\nconst hide = setAttribute('aria-hidden', 'true');\r\n\r\n/**\r\n * @function\r\n */\r\nconst show = setAttribute('aria-hidden', 'false');\r\n\r\n/**\r\n * Toggles the visibility if an element\r\n *\r\n * @param {HTMLElement} element\r\n * @param {boolean} visible\r\n */\r\nconst toggleVisibility = (element, visible) => (visible ? show : hide)(element);\r\n\r\n/**\r\n * Checks if a string is empty\r\n *\r\n * @param {string} text\r\n *\r\n * @return {boolean}\r\n */\r\nconst isEmpty = (text) => (typeof text === 'string') && (text.length === 0);\r\n\r\n/**\r\n * Propagates row selection trough the event system\r\n *\r\n * @param {Eventful} eventful\r\n * @param {HTMLElement} element\r\n *\r\n * @function\r\n * @return {HTMLElement}\r\n */\r\nconst relayClickEventAs = curry(function(type, eventful, element) {\r\n  element.addEventListener('click', event => {\r\n    eventful.fire(type, {\r\n      element: element,\r\n      id: getAttribute(ATTRIBUTE_CONTENT_TYPE_ID, element)\r\n    })\r\n  });\r\n\r\n  return element;\r\n});\r\n\r\n/**\r\n * @class\r\n * @mixes Eventful\r\n */\r\nexport default class ContentTypeDetailView {\r\n  constructor(state) {\r\n    // add event system\r\n    Object.assign(this, Eventful());\r\n\r\n    // back button\r\n    const backButtonElement = document.createElement('div');\r\n    backButtonElement.className = 'back-button icon-arrow-thick';\r\n    relayClickEventAs('close', this, backButtonElement);\r\n\r\n    // image\r\n    this.image = document.createElement('img');\r\n    this.image.className = 'img-responsive';\r\n\r\n    const imageWrapperElement = document.createElement('div');\r\n    imageWrapperElement.className = 'image-wrapper';\r\n    imageWrapperElement.appendChild(this.image);\r\n\r\n    // title\r\n    this.title = document.createElement('h2');\r\n    this.title.className = 'title';\r\n\r\n    // description\r\n    this.description = document.createElement('p');\r\n    this.description.className = 'description';\r\n\r\n    // demo button\r\n    this.demoButton = document.createElement('a');\r\n    this.demoButton.className = 'button';\r\n    this.demoButton.innerHTML = 'Content Demo';\r\n    this.demoButton.setAttribute('target', '_blank');\r\n    hide(this.demoButton);\r\n\r\n    const textDetails = document.createElement('div');\r\n    textDetails.className = 'text-details';\r\n    textDetails.appendChild(this.title);\r\n    textDetails.appendChild(this.description);\r\n    textDetails.appendChild(this.demoButton);\r\n\r\n    const detailsElement = document.createElement('div');\r\n    detailsElement.className = 'container';\r\n    detailsElement.appendChild(imageWrapperElement);\r\n    detailsElement.appendChild(textDetails);\r\n\r\n    // use button\r\n    this.useButton = document.createElement('span');\r\n    this.useButton.className = 'button button-primary';\r\n    this.useButton.innerHTML = 'Use';\r\n    hide(this.useButton);\r\n    relayClickEventAs('select', this, this.useButton);\r\n\r\n    // install button\r\n    this.installButton = document.createElement('span');\r\n    this.installButton.className = 'button button-inverse-primary';\r\n    this.installButton.innerHTML = 'Install';\r\n    hide(this.installButton);\r\n    relayClickEventAs('install', this, this.installButton);\r\n\r\n    const buttonBar = document.createElement('div');\r\n    buttonBar.className = 'button-bar';\r\n    buttonBar.appendChild(this.useButton);\r\n    buttonBar.appendChild(this.installButton);\r\n\r\n    // licence panel\r\n    const licencePanel = this.createPanel('The Licence Info', 'ipsum lorum', 'licence-panel');\r\n    const pluginsPanel = this.createPanel('Available plugins', 'ipsum lorum', 'plugins-panel');\r\n    const publisherPanel = this.createPanel('Publisher Info', 'ipsum lorum', 'publisher-panel');\r\n\r\n    // panel group\r\n    const panelGroupElement = document.createElement('div');\r\n    panelGroupElement.className = 'panel-group';\r\n    panelGroupElement.appendChild(licencePanel);\r\n    panelGroupElement.appendChild(pluginsPanel);\r\n    panelGroupElement.appendChild(publisherPanel);\r\n\r\n    // add root element\r\n    this.rootElement = document.createElement('div');\r\n    this.rootElement.className = 'content-type-detail';\r\n    this.rootElement.setAttribute('aria-hidden', 'true');\r\n    this.rootElement.appendChild(backButtonElement);\r\n    this.rootElement.appendChild(detailsElement);\r\n    this.rootElement.appendChild(buttonBar);\r\n    this.rootElement.appendChild(panelGroupElement);\r\n  }\r\n\r\n  /**\r\n   * Creates a panel\r\n   *\r\n   * @param {string} title\r\n   * @param {string} body\r\n   * @param {string} bodyId\r\n   *\r\n   * @return {HTMLElement}\r\n   */\r\n  createPanel(title, body, bodyId) {\r\n    const headerEl = document.createElement('div');\r\n    headerEl.className = 'panel-header';\r\n    headerEl.setAttribute('aria-expanded', 'false');\r\n    headerEl.setAttribute('aria-controls', bodyId);\r\n    headerEl.innerHTML = title;\r\n\r\n    const bodyInnerEl = document.createElement('div');\r\n    bodyInnerEl.className = 'panel-body-inner';\r\n    bodyInnerEl.innerHTML = body;\r\n\r\n    const bodyEl = document.createElement('div');\r\n    bodyEl.className = 'panel-body';\r\n    bodyEl.id = bodyId;\r\n    bodyEl.setAttribute('aria-hidden', 'true');\r\n    bodyEl.appendChild(bodyInnerEl);\r\n\r\n    const panelEl = document.createElement('div');\r\n    panelEl.className = 'panel';\r\n    panelEl.appendChild(headerEl);\r\n    panelEl.appendChild(bodyEl);\r\n\r\n    initPanel(panelEl);\r\n\r\n    return panelEl;\r\n  }\r\n\r\n  /**\r\n   * Sets the image\r\n   *\r\n   * @param {string} src\r\n   */\r\n  setImage(src) {\r\n    this.image.setAttribute('src', src);\r\n  }\r\n\r\n  /**\r\n   * Sets the title\r\n   *\r\n   * @param {string} id\r\n   */\r\n  setId(id) {\r\n    this.installButton.setAttribute(ATTRIBUTE_CONTENT_TYPE_ID, id);\r\n    this.useButton.setAttribute(ATTRIBUTE_CONTENT_TYPE_ID, id);\r\n  }\r\n\r\n  /**\r\n   * Sets the title\r\n   *\r\n   * @param {string} title\r\n   */\r\n  setTitle(title) {\r\n    this.title.innerHTML = title;\r\n  }\r\n\r\n  /**\r\n   * Sets the long description\r\n   *\r\n   * @param {string} text\r\n   */\r\n  setDescription(text) {\r\n    this.description.innerHTML = text;\r\n  }\r\n\r\n  /**\r\n   * Sets the example url\r\n   *\r\n   * @param {string} url\r\n   */\r\n  setExample(url) {\r\n    this.demoButton.setAttribute('href', url || '#');\r\n    toggleVisibility(this.demoButton, !isEmpty(url));\r\n  }\r\n\r\n  /**\r\n   * Sets if the content type is installed\r\n   *\r\n   * @param {boolean} installed\r\n   */\r\n  setIsInstalled(installed) {\r\n    toggleVisibility(this.useButton, installed);\r\n    toggleVisibility(this.installButton, !installed);\r\n  }\r\n\r\n  /**\r\n   * Hides the root element\r\n   */\r\n  hide() {\r\n    hide(this.rootElement);\r\n  }\r\n\r\n  /**\r\n   * Shows the root element\r\n   */\r\n  show() {\r\n    show(this.rootElement);\r\n  }\r\n\r\n  /**\r\n   * Returns the root html element\r\n   * @return {HTMLElement}\r\n   */\r\n  getElement() {\r\n    return this.rootElement;\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/scripts/content-type-detail/content-type-detail-view.js","import ContetTypeDetailView from \"./content-type-detail-view\";\r\nimport HubServices from \"../hub-services\";\r\nimport { Eventful } from '../mixins/eventful';\r\n\r\n/**\r\n * @class\r\n * @mixes Eventful\r\n */\r\nexport default class ContentTypeDetail {\r\n  constructor(state) {\r\n    // add event system\r\n    Object.assign(this, Eventful());\r\n\r\n    // services\r\n    this.services = new HubServices({\r\n      apiRootUrl: state.apiRootUrl\r\n    });\r\n\r\n    // views\r\n    this.view = new ContetTypeDetailView(state);\r\n    this.view.on('install', this.install, this);\r\n\r\n    // propagate events\r\n    this.propagate(['close', 'select'], this.view);\r\n  }\r\n\r\n  /**\r\n   * Hides the detail view\r\n   */\r\n  hide() {\r\n    this.view.hide();\r\n  }\r\n\r\n  /**\r\n   * Shows the detail view\r\n   */\r\n  show() {\r\n    this.view.show();\r\n  }\r\n\r\n  /**\r\n   * Loads a Content Type description\r\n   *\r\n   * @param {string} id\r\n   *\r\n   * @return {Promise.<ContentType>}\r\n   */\r\n  loadById(id) {\r\n    this.services.contentType(id)\r\n      .then(this.update.bind(this))\r\n  }\r\n\r\n  /**\r\n   * Loads a Content Type description\r\n   *\r\n   * @param {string} id\r\n   *\r\n   * @return {Promise.<ContentType>}\r\n   */\r\n   install({id}) {\r\n     return this.services.contentType(id)\r\n       .then(contentType => contentType.machineName)\r\n       .then(machineName => this.services.installContentType(machineName))\r\n       .then(contentType => console.debug('TODO, gui updates'))\r\n   }\r\n\r\n  /**\r\n   * Updates the view with the content type data\r\n   *\r\n   * @param {ContentType} contentType\r\n   */\r\n  update(contentType) {\r\n    this.view.setId(contentType.machineName);\r\n    this.view.setTitle(contentType.title);\r\n    this.view.setDescription(contentType.description);\r\n    this.view.setImage(contentType.icon);\r\n    this.view.setExample(contentType.example);\r\n    this.view.setIsInstalled(!!contentType.installed);\r\n  }\r\n\r\n  /**\r\n   * Returns the root html element\r\n   *\r\n   * @return {HTMLElement}\r\n   */\r\n  getElement() {\r\n    return this.view.getElement();\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/scripts/content-type-detail/content-type-detail.js","import { curry } from \"utils/functional\";\r\nimport { setAttribute, getAttribute } from \"utils/elements\";\r\nimport { Eventful } from '../mixins/eventful';\r\n\r\n/**\r\n * @constant {string}\r\n */\r\nconst ATTRIBUTE_CONTENT_TYPE_ID = 'data-id';\r\n\r\n/**\r\n * @function\r\n */\r\nconst hide = setAttribute('aria-hidden', 'true');\r\n\r\n/**\r\n * @function\r\n */\r\nconst show = setAttribute('aria-hidden', 'false');\r\n\r\n/**\r\n * Propagates row selection trough the event system\r\n *\r\n * @param {Eventful} eventful\r\n * @param {HTMLElement} element\r\n *\r\n * @function\r\n * @return {HTMLElement}\r\n */\r\nconst relayClickEventAs = curry(function(type, eventful, element) {\r\n  element.addEventListener('click', event => {\r\n    eventful.fire(type, {\r\n      element: element,\r\n      id: getAttribute(ATTRIBUTE_CONTENT_TYPE_ID, element)\r\n    }, false);\r\n\r\n    event.preventDefault();\r\n  });\r\n\r\n  return element;\r\n});\r\n\r\n/**\r\n * @class\r\n * @mixes Eventful\r\n */\r\nexport default class ContentTypeListView {\r\n  constructor(state) {\r\n    this.state = state;\r\n\r\n    // add event system\r\n    Object.assign(this, Eventful());\r\n\r\n    // create root element\r\n    this.rootElement = document.createElement('ul');\r\n    this.rootElement.className = 'content-type-list';\r\n  }\r\n\r\n  /**\r\n   * Hides the root element\r\n   */\r\n  hide() {\r\n    hide(this.rootElement);\r\n  }\r\n\r\n  /**\r\n   * Shows the root element\r\n   */\r\n  show() {\r\n    show(this.rootElement);\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param {ContentType[]} contentTypes\r\n   */\r\n  updateList(contentTypes) {\r\n    if(this.rootElement){\r\n      while(this.rootElement.firstChild ){\r\n        this.rootElement.removeChild(this.rootElement.firstChild);\r\n      }\r\n    }\r\n\r\n    this.renderContentTypeList(contentTypes)\r\n      .forEach(contentType => this.rootElement.appendChild(contentType));\r\n  }\r\n\r\n  /**\r\n   * Applies create rows, and add to the list\r\n   *\r\n   * @param {ContentType[]} contentTypes\r\n   *\r\n   * @return {HTMLElement[]}\r\n   */\r\n  renderContentTypeList(contentTypes) {\r\n    return contentTypes\r\n      .map(contentType => this.createContentTypeRow(contentType))\r\n      .map(relayClickEventAs('row-selected', this))\r\n  }\r\n\r\n  /**\r\n   * Takes a Content Type configuration and creates a row dom\r\n   *\r\n   * @param {ContentType} contentType\r\n   *\r\n   * @return {HTMLElement}\r\n   */\r\n  createContentTypeRow(contentType) {\r\n    // image\r\n    const image = document.createElement('img');\r\n    image.setAttribute('src', contentType.icon);\r\n\r\n    // title\r\n    const title = document.createElement('div');\r\n    title.className = 'content-type-list-title';\r\n    title.innerHTML = contentType.title;\r\n\r\n    // description\r\n    const description = document.createElement('div');\r\n    description.className = 'content-type-list-description';\r\n    description.innerHTML = contentType.summary;\r\n\r\n    // list item\r\n    const row = document.createElement('li');\r\n    row.id = `content-type-${contentType.machineName}`;\r\n    row.setAttribute(ATTRIBUTE_CONTENT_TYPE_ID, contentType.machineName);\r\n    row.appendChild(image);\r\n    row.appendChild(this.createButtonElement(contentType));\r\n    row.appendChild(title);\r\n    row.appendChild(description);\r\n\r\n    return row;\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param {ContentType} contentType\r\n   */\r\n  createButtonElement(contentType) {\r\n    const button = document.createElement('span');\r\n\r\n    if(contentType.installed) {\r\n      button.className = \"button button-primary\";\r\n      button.innerHTML = \"Use\";\r\n      button.setAttribute(ATTRIBUTE_CONTENT_TYPE_ID, contentType.machineName);\r\n      relayClickEventAs('select', this, button);\r\n    }\r\n    else {\r\n      button.className = \"button button-inverse-primary\";\r\n      button.innerHTML = \"install\";\r\n      // no functionality, uses click event on row\r\n    }\r\n\r\n    return button;\r\n  }\r\n\r\n  /**\r\n   * Returns the root element\r\n   *\r\n   * @return {HTMLElement}\r\n   */\r\n  getElement() {\r\n    return this.rootElement;\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/scripts/content-type-list/content-type-list-view.js","import ContetTypeListView from \"./content-type-list-view\";\r\nimport {Eventful} from '../mixins/eventful';\r\n\r\n/**\r\n * @class\r\n * @mixes Eventful\r\n */\r\nexport default class ContentTypeList {\r\n  constructor(state) {\r\n    // add event system\r\n    Object.assign(this, Eventful());\r\n\r\n    // add the view\r\n    this.view = new ContetTypeListView(state);\r\n    this.propagate(['row-selected', 'select'], this.view);\r\n  }\r\n\r\n  hide() {\r\n    this.view.hide();\r\n  }\r\n\r\n  show() {\r\n    this.view.show();\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param {ContentType[]} contentTypes\r\n   */\r\n  update(contentTypes) {\r\n    this.view.updateList(contentTypes);\r\n  }\r\n\r\n  getElement() {\r\n    return this.view.getElement();\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/scripts/content-type-list/content-type-list.js","import {Eventful} from '../mixins/eventful';\r\n\r\n/**\r\n * @class ContentBrowserView\r\n * @mixes Eventful\r\n */\r\nexport default class ContentBrowserView {\r\n  /**\r\n   * @constructor\r\n   * @param {object} state\r\n   */\r\n  constructor(state) {\r\n    // add event system\r\n    Object.assign(this, Eventful());\r\n\r\n    // create elements\r\n    const menu = this.createMenuElement();\r\n    const inputGroup = this.createInputGroupElement();\r\n\r\n    // menu group\r\n    const menuGroup = document.createElement('div');\r\n    menuGroup.className = 'menu-group';\r\n    menuGroup.appendChild(menu);\r\n    menuGroup.appendChild(inputGroup);\r\n\r\n    // root element\r\n    this.rootElement  = document.createElement('div');\r\n    this.rootElement.appendChild(menuGroup);\r\n  }\r\n\r\n  /**\r\n   * Adds a menu item\r\n   *\r\n   * @param {string} text\r\n   *\r\n   * @return {HTMLElement}\r\n   */\r\n  addMenuItem(text) {\r\n    const element = document.createElement('li');\r\n    element.setAttribute('role', 'menuitem');\r\n    element.innerHTML = text;\r\n\r\n    element.addEventListener('click', event => {\r\n      this.fire('menu-selected', {\r\n        element: event.target\r\n      });\r\n    });\r\n\r\n    // sets first to be selected\r\n    if(this.menuBarElement.childElementCount < 1) {\r\n      element.setAttribute('aria-selected', 'true');\r\n    }\r\n\r\n    // add to menu bar\r\n    this.menuBarElement.appendChild(element);\r\n\r\n    return element;\r\n  }\r\n\r\n  /**\r\n   * Creates the menu bar element\r\n   *\r\n   * @return {Element}\r\n   */\r\n  createMenuElement() {\r\n    this.menuBarElement = document.createElement('ul');\r\n    this.menuBarElement.setAttribute('role', 'menubar');\r\n    this.menuBarElement.className = 'h5p-menu';\r\n\r\n    const navElement = document.createElement('nav');\r\n    navElement.appendChild(this.menuBarElement);\r\n\r\n    const title = document.createElement('div');\r\n    title.className = \"menu-title\";\r\n    title.innerHTML = \"Browse content types\";\r\n\r\n    const menu = document.createElement('div');\r\n    menu.className = \"menu\";\r\n    menu.appendChild(title);\r\n    menu.appendChild(navElement);\r\n\r\n    return menu;\r\n  }\r\n\r\n  /**\r\n   * Creates the input group used for search\r\n   *\r\n   * @return {HTMLElement}\r\n   */\r\n  createInputGroupElement() {\r\n    // input field\r\n    const inputField = document.createElement('input');\r\n    inputField.className = 'hub-search shadow';\r\n    inputField.setAttribute('type', 'text');\r\n    inputField.setAttribute('placeholder', \"Search for Content Types\");\r\n    inputField.addEventListener('keyup', event => {\r\n      this.fire('search', {\r\n        element: event.target,\r\n        query: event.target.value\r\n      });\r\n    });\r\n\r\n    // input button\r\n    const inputButton = document.createElement('div');\r\n    inputButton.className = 'input-button icon-search';\r\n\r\n    // input group\r\n    const inputGroup = document.createElement('div');\r\n    inputGroup.className = 'input-group rounded shadow';\r\n    inputGroup.appendChild(inputField);\r\n    inputGroup.appendChild(inputButton);\r\n\r\n    // wrapper\r\n    const inputGroupWrapper = document.createElement('div');\r\n    inputGroupWrapper.className = 'input-group-wrapper rounded';\r\n    inputGroupWrapper.appendChild(inputGroup);\r\n\r\n    return inputGroupWrapper;\r\n  }\r\n\r\n  /**\r\n   * Returns the root element of the content browser\r\n   *\r\n   * @return {HTMLElement}\r\n   */\r\n  getElement() {\r\n    return this.rootElement;\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/scripts/content-type-section/content-type-section-view.js","import ContentTypeSectionView from \"./content-type-section-view\";\r\nimport SearchService from \"../search-service/search-service\";\r\nimport ContentTypeList from '../content-type-list/content-type-list';\r\nimport ContentTypeDetail from '../content-type-detail/content-type-detail';\r\nimport {Eventful} from '../mixins/eventful';\r\nimport {renderErrorMessage} from '../utils/errors';\r\n\r\n/**\r\n * @class ContentTypeSection\r\n * @mixes Eventful\r\n */\r\nexport default class ContentTypeSection {\r\n  /**\r\n   * @param {HubState} state\r\n   */\r\n  constructor(state) {\r\n    // add event system\r\n    Object.assign(this, Eventful());\r\n\r\n    // add view\r\n    this.view = new ContentTypeSectionView(state);\r\n\r\n    // controller\r\n    this.searchService = new SearchService({ apiRootUrl: state.apiRootUrl });\r\n    this.contentTypeList = new ContentTypeList();\r\n    this.contentTypeDetail = new ContentTypeDetail({ apiRootUrl: state.apiRootUrl });\r\n\r\n    // add menu items\r\n    ['My Content Types', 'Newest', 'Most Popular', 'Recommended']\r\n      .forEach(menuText => this.view.addMenuItem(menuText));\r\n\r\n    // set sub view (TODO find other way)\r\n    this.view.getElement().appendChild(this.contentTypeList.getElement());\r\n    this.view.getElement().appendChild(this.contentTypeDetail.getElement());\r\n\r\n    // propagate events\r\n    this.propagate(['select'], this.contentTypeList);\r\n    this.propagate(['select'], this.contentTypeDetail);\r\n\r\n    // register listeners\r\n    this.view.on('search', this.search, this);\r\n    this.view.on('menu-selected', this.applySearchFilter, this);\r\n    this.contentTypeList.on('row-selected', this.showDetailView, this);\r\n    this.contentTypeDetail.on('close', this.closeDetailView, this);\r\n\r\n    this.initContentTypeList();\r\n  }\r\n\r\n  /**\r\n   * Initiates the content type list with a search\r\n   */\r\n  initContentTypeList() {\r\n    // initialize by search\r\n    this.searchService.search(\"\")\r\n      .then(contentTypes => this.contentTypeList.update(contentTypes))\r\n      .catch(error => this.fire('error', error));\r\n  }\r\n\r\n  /**\r\n   * Executes a search and updates the content type list\r\n   *\r\n   * @param {string} query\r\n   */\r\n  search({query}) {\r\n    this.searchService.search(query)\r\n      .then(contentTypes => this.contentTypeList.update(contentTypes));\r\n  }\r\n\r\n  /**\r\n   * Should apply a search filter\r\n   */\r\n  applySearchFilter() {\r\n    console.debug('ContentTypeSection: menu was clicked!', event);\r\n  }\r\n\r\n  /**\r\n   * Shows detail view\r\n   *\r\n   * @param {string} id\r\n   */\r\n  showDetailView({id}) {\r\n    this.contentTypeList.hide();\r\n    this.contentTypeDetail.loadById(id);\r\n    this.contentTypeDetail.show();\r\n  }\r\n\r\n\r\n  /**\r\n   * Close detail view\r\n   */\r\n  closeDetailView() {\r\n    this.contentTypeDetail.hide();\r\n    this.contentTypeList.show();\r\n  }\r\n\r\n  /**\r\n   * Returns the element\r\n   *\r\n   * @return {HTMLElement}\r\n   */\r\n  getElement() {\r\n    return this.view.getElement();\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/scripts/content-type-section/content-type-section.js","import initPanel from \"components/panel\"\r\nimport initTabPanel from \"components/tab-panel\"\r\nimport { attributeEquals } from \"utils/elements\";\r\n\r\n/**\r\n * @const\r\n * @type {string}\r\n */\r\nconst ATTRIBUTE_ARIA_EXPANDED = \"aria-expanded\";\r\n\r\n/**\r\n * @type {function}\r\n */\r\nconst isExpanded = attributeEquals(ATTRIBUTE_ARIA_EXPANDED, 'true');\r\n\r\n/**\r\n * @class\r\n */\r\nexport default class HubView {\r\n  /**\r\n   * @param {HubState} state\r\n   */\r\n  constructor(state) {\r\n    this.renderTabPanel(state);\r\n    this.renderPanel(state);\r\n  }\r\n\r\n  /**\r\n   * Closes the panel\r\n   */\r\n  closePanel() {\r\n    this.title.setAttribute('aria-expanded', 'false')\r\n  }\r\n\r\n  /**\r\n   * Sets the title\r\n   *\r\n   * @param {string} title\r\n   */\r\n  setTitle(title) {\r\n    this.title.innerHTML = title;\r\n  }\r\n\r\n  /**\r\n   * Creates the dom for the panel\r\n   *\r\n   * @param {string} title\r\n   * @param {string} sectionId\r\n   * @param {boolean} expanded\r\n   */\r\n  renderPanel({title = '', sectionId = 'create-content', expanded = false}) {\r\n    /**\r\n     * @type {HTMLElement}\r\n     */\r\n    this.title = document.createElement('div');\r\n    this.title.className += \"panel-header icon-hub-icon\";\r\n    this.title.setAttribute('aria-expanded', (!!expanded).toString());\r\n    this.title.setAttribute('aria-controls', `panel-body-${sectionId}`);\r\n    this.title.innerHTML = title;\r\n\r\n    /**\r\n     * @type {HTMLElement}\r\n     */\r\n    this.body = document.createElement('div');\r\n    this.body.className += \"panel-body\";\r\n    this.body.setAttribute('aria-hidden', (!expanded).toString());\r\n    this.body.id = `panel-body-${sectionId}`;\r\n    this.body.appendChild(this.tabContainerElement);\r\n\r\n    /**\r\n     * @type {HTMLElement}\r\n     */\r\n    this.rootElement = document.createElement('div');\r\n    this.rootElement.className += `h5p-hub h5p-section-${sectionId} panel`;\r\n    this.rootElement.appendChild(this.title);\r\n    this.rootElement.appendChild(this.body);\r\n\r\n    initPanel(this.rootElement);\r\n  }\r\n\r\n  /**\r\n   * Creates the dom for the tab panel\r\n   */\r\n  renderTabPanel(state) {\r\n    /**\r\n     * @type {HTMLElement}\r\n     */\r\n    this.tablist = document.createElement('ul');\r\n    this.tablist.className += \"tablist\";\r\n    this.tablist.setAttribute ('role', 'tablist');\r\n\r\n    /**\r\n     * @type {HTMLElement}\r\n     */\r\n    this.tabListWrapper = document.createElement('nav');\r\n    this.tabListWrapper.appendChild(this.tablist);\r\n\r\n    /**\r\n     * @type {HTMLElement}\r\n     */\r\n    this.tabContainerElement = document.createElement('div');\r\n    this.tabContainerElement.className += 'tab-panel';\r\n    this.tabContainerElement.appendChild(this.tabListWrapper);\r\n  }\r\n\r\n  /**\r\n   * Adds a tab\r\n   *\r\n   * @param {string} title\r\n   * @param {string} id\r\n   * @param {HTMLElement} content\r\n   * @param {boolean} selected\r\n   */\r\n  addTab({title, id, content, selected = false}) {\r\n    const tabId = `tab-${id}`;\r\n    const tabPanelId = `tab-panel-${id}`;\r\n\r\n    const tab = document.createElement('li');\r\n    tab.className += 'tab';\r\n    tab.id = tabId;\r\n    tab.setAttribute('aria-controls', tabPanelId);\r\n    tab.setAttribute('aria-selected', selected.toString());\r\n    tab.setAttribute('role', 'tab');\r\n    tab.innerHTML = title;\r\n\r\n    const tabPanel = document.createElement('div');\r\n    tabPanel.id = tabPanelId;\r\n    tabPanel.className += 'tabpanel';\r\n    tabPanel.setAttribute('aria-lablledby', tabId);\r\n    tabPanel.setAttribute('aria-hidden', (!selected).toString());\r\n    tabPanel.setAttribute('role', 'tabpanel');\r\n    tabPanel.appendChild(content);\r\n\r\n    this.tablist.appendChild(tab);\r\n    this.tabContainerElement.appendChild(tabPanel);\r\n  }\r\n\r\n  initTabPanel() {\r\n    initTabPanel(this.tabContainerElement);\r\n  }\r\n\r\n  /**\r\n   * Sets the section\r\n   *\r\n   * @param {string} sectionId\r\n   */\r\n  setSection(sectionId) {\r\n    this.rootElement.className = `h5p-hub h5p-section-${sectionId} panel`;\r\n  }\r\n\r\n  /**\r\n   * Returns the root html element\r\n   *\r\n   * @return {HTMLElement}\r\n   */\r\n  getElement() {\r\n    return this.rootElement;\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/scripts/hub-view.js","import {curry, map, filter} from \"utils/functional\"\r\nimport HubServices from \"../hub-services\";\r\nimport lunr from \"lunr\"\r\n\r\nconst findContentTypeByMachineName = curry(function(contentTypes, machineName) {\r\n  return contentTypes.filter(contentType => contentType.machineName === machineName)[0];\r\n});\r\n\r\n\r\n/**\r\n * Adds a content type to the search index\r\n *\r\n * @param  {lunr.Index} index\r\n * @param  {ContentType} contentType\r\n *\r\n * @return {ContentType}\r\n */\r\nconst addToIndex = curry((index, contentType) => {\r\n  index.add({\r\n    title: contentType.title,\r\n    summary: contentType.summary,\r\n    id: contentType.machineName\r\n  });\r\n\r\n  return contentType;\r\n});\r\n\r\n/**\r\n * @class\r\n */\r\nexport default class SearchService {\r\n  /**\r\n   * @param {object} state\r\n   * @param {string} state.apiRootUrl\r\n   */\r\n  constructor(state) {\r\n    this.services = new HubServices({\r\n      apiRootUrl: state.apiRootUrl\r\n    });\r\n\r\n    // Set up lunr index\r\n    this.index = lunr(function() {\r\n      this.field('title', {boost: 100});\r\n      this.field('summary');\r\n      this.field('description');\r\n      this.field('keywords');\r\n      this.ref('id');\r\n    });\r\n\r\n    this.contentTypes = this.services.contentTypes()\r\n      .then(map(addToIndex(this.index))); // Add content types to search index\r\n  }\r\n\r\n  /**\r\n   * Performs a search\r\n   *\r\n   * @param {String} query\r\n   *\r\n   * @return {Promise<ContentType[]>}\r\n   */\r\n  search(query) {\r\n    // Display all content types by default\r\n    if (query === '') {\r\n      return this.contentTypes;\r\n    }\r\n\r\n    return this.contentTypes.then(contentTypes => {\r\n      return this.index.search(query)\r\n        .map(result => result.ref)\r\n        .map(findContentTypeByMachineName(contentTypes))\r\n    });\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/scripts/search-service/search-service.js","/**\r\n * @class\r\n */\r\nexport default class UploadSection {\r\n  getElement() {\r\n    const element = document.createElement('div');\r\n    element.innerHTML = \"TODO Upload\";\r\n    return element;\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/scripts/upload-section/upload-section.js","require('../../src/styles/main.scss');\r\n\r\n// Load library\r\nH5P = H5P || {};\r\nH5P.HubClient = require('../scripts/hub').default;\r\nH5P.HubClient.renderErrorMessage = require('../scripts/utils/errors').default;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/entries/dist.js"],"sourceRoot":""}